{"version":3,"sources":["node_modules/frappe-charts/dist/frappe-charts.esm.js","script.js"],"names":["$","expr","con","document","querySelector","getOffset","element","rect","getBoundingClientRect","top","documentElement","scrollTop","body","left","scrollLeft","isHidden","el","offsetParent","isElementInViewport","bottom","window","innerHeight","clientHeight","right","innerWidth","clientWidth","getElementContentWidth","styles","getComputedStyle","padding","parseFloat","paddingLeft","paddingRight","fire","target","type","properties","evt","createEvent","j","initEvent","dispatchEvent","create","tag","o","createElement","i","val","appendChild","ref","parentNode","insertBefore","Object","keys","map","prop","style","setAttribute","BASE_MEASURES","margins","paddings","baseHeight","titleHeight","legendHeight","titleFontSize","getTopOffset","m","getLeftOffset","getExtraHeight","totalExtraHeight","getExtraWidth","totalExtraWidth","INIT_CHART_UPDATE_TIMEOUT","CHART_POST_ANIMATE_TIMEOUT","DEFAULT_AXIS_CHART_TYPE","AXIS_DATASET_CHART_TYPES","AXIS_LEGEND_BAR_SIZE","BAR_CHART_SPACE_RATIO","MIN_BAR_PERCENT_HEIGHT","LINE_CHART_DOT_SIZE","DOT_OVERLAY_SIZE_INCR","PERCENTAGE_BAR_DEFAULT_HEIGHT","PERCENTAGE_BAR_DEFAULT_DEPTH","HEATMAP_DISTRIBUTION_SIZE","HEATMAP_SQUARE_SIZE","HEATMAP_GUTTER_SIZE","DEFAULT_CHAR_WIDTH","TOOLTIP_POINTER_TRIANGLE_HEIGHT","DEFAULT_CHART_COLORS","HEATMAP_COLORS_GREEN","DEFAULT_COLORS","bar","line","pie","percentage","heatmap","donut","ANGLE_RATIO","Math","PI","FULL_ANGLE","SvgTip","constructor","parent","colors","titleName","titleValue","listValues","titleValueFirst","x","y","setup","makeTooltip","refresh","fill","calcPosition","container","inside","className","innerHTML","hideTip","title","dataPointList","addEventListener","index","set","color","value","formatted","li","width","offsetWidth","offsetHeight","maxLeft","pointer","delta","pointerOffset","setValues","name","valueFirst","opacity","showTip","floatTwo","d","toFixed","fillArray","array","count","start","length","fillerArray","Array","abs","concat","getStringWidth","string","charWidth","getPositionByAngle","angle","radius","sin","cos","isValidNumber","candidate","nonNegative","Number","isNaN","undefined","isFinite","getBarHeightAndYAttr","yTop","zeroLine","height","equilizeNoOfElements","array1","array2","extraCount","truncateString","txt","len","slice","shortenLargeNumber","label","number","p","floor","log10","l","shortened","pow","round","getSplineCurvePointsStr","xList","yList","points","push","smoothing","controlPoint","current","previous","next","reverse","pointA","pointB","lengthX","lengthY","sqrt","atan2","pointStr","command","reduce","acc","point","a","cps","cpe","PRESET_COLOR_MAP","limitColor","r","lightenDarkenColor","amt","col","getColor","usePound","num","parseInt","b","toString","isValidColor","HEX_RE","test","AXIS_TICK_LENGTH","LABEL_MARGIN","LABEL_MAX_CHARS","FONT_SIZE","BASE_LINE_COLOR","FONT_FILL","$$1","createSVG","createElementNS","renderVerticalGradient","svgDefElem","gradientId","id","x1","x2","y1","y2","setGradientStop","gradElem","offset","makeSVGContainer","makeSVGDefs","svgContainer","makeSVGGroup","transform","args","makePath","pathStr","stroke","strokeWidth","makeArcPathStr","startPosition","endPosition","center","clockWise","largeArc","arcStartX","arcStartY","arcEndX","arcEndY","makeCircleStr","midArc","makeArcStrokePathStr","makeStrokeCircleStr","makeGradient","lighter","gradientDef","opacities","percentageBar","depth","heatSquare","size","data","rx","key","legendBar","truncate","text","dy","group","legendDot","cx","cy","dx","makeText","content","options","fontSize","textAnchor","makeVertLine","makeHoriLine","lineType","shortenNumbers","yLine","pos","mode","xLine","yMarker","labelPos","labelSvg","yRegion","region","datasetBar","meta","minHeight","datasetDot","dot","getPaths","pointsList","pointsStr","join","spline","path","heatline","gradient_id","svgDefs","paths","regionFill","gradient_id_region","makeOverlay","unit","transformValue","nodeName","getAttribute","childNodes","overlay","cloneNode","updateOverlay","attributes","values","filter","attr","includes","specified","nodeValue","UNIT_ANIM_DUR","PATH_ANIM_DUR","MARKER_LINE_ANIM_DUR","REPLACE_ALL_NEW_DUR","STD_EASING","translate","oldCoord","newCoord","duration","old","translateVertLine","newX","oldX","translateHoriLine","newY","oldY","animateRegion","rectGroup","newY1","newY2","oldY2","newHeight","animateBar","rectAnim","oldCoordStr","split","animateDot","animatePath","newXList","newYList","pathComponents","animPath","regStartPt","regEndPt","animRegion","animatePathStr","oldPath","EASING","ease","linear","easein","easeout","easeinout","animateSVGElement","props","dur","easingType","oldValues","animElement","newElement","attributeName","animateElement","currentValue","animAttr","from","to","begin","keySplines","keyTimes","calcMode","webkitTransform","msTransform","mozTransform","oTransform","animateSVG","elements","newElements","animElements","replaceChild","animSvg","runSMILAnimation","svgElement","elementsToAnimate","animSvgElement","removeChild","setTimeout","CSSTEXT","downloadFile","filename","blob","Blob","url","URL","createObjectURL","href","download","click","revokeObjectURL","prepareForExport","svg","clone","classList","add","styleEl","firstChild","BaseChart","HTMLElement","Error","rawChartArgs","realData","prepareData","prepareFirstData","validateColors","config","showTooltip","showLegend","isNavigable","animate","truncateLegends","measures","JSON","parse","stringify","setMeasures","argHeight","state","initTimeout","overlays","configure","validColors","forEach","console","warn","boundDrawFn","draw","destroy","removeEventListener","makeContainer","updateWidth","independentWidth","tip","bindTooltip","onlyWidthChange","init","calc","makeChartArea","setupComponents","components","c","drawArea","render","update","renderLegend","setupNavigation","baseWidth","titleEL","legendArea","updateTipOffset","Map","error","make","updateNav","bindUnits","bindOverlay","keyActions","onEnterKey","bind","onLeftArrow","onUpArrow","onRightArrow","onDownArrow","e","event","keyCode","addDataPoint","removeDataPoint","getDataPoint","setCurrentDataPoint","updateDataset","export","chartSvg","AggregationChart","maxSlices","maxLegendPoints","s","sliceTotals","allTotals","labels","total","datasets","totals","sort","remaining","sumOfRemaining","grandTotal","textContent","legendTotals","barWidth","divisor","NO_OF_YEAR_MONTHS","NO_OF_DAYS_IN_WEEK","NO_OF_MILLIS","SEC_IN_DAY","MONTH_NAMES","DAY_NAMES_SHORT","treatAsUtc","date","result","Date","setMinutes","getMinutes","getTimezoneOffset","getYyyyMmDd","dd","getDate","mm","getMonth","getFullYear","getTime","getWeeksBetween","startDate","endDate","weekStartDate","setDayToSunday","ceil","getDaysBetween","millisecondsPerDay","areInSameMonth","getMonthName","short","monthName","getLastDateInMonth","month","year","newDate","day","getDay","addDays","numberOfDays","setDate","ChartComponent","layerClass","layerTransform","constants","getData","makeElements","animateElements","store","layer","oldData","componentConfigs","donutSlices","sliceStrings","transition","newData","pieSlices","percentageBars","xPositions","widths","barHeight","barDepth","yAxis","positions","position","newPos","newLabels","oldPos","oldLabels","xAxis","calcLabels","yMarkers","newOptions","yRegions","startPos","endPos","newStarts","oldStarts","heatDomain","colWidth","rowHeight","squareSize","xTranslate","serializedSubDomains","cols","week","weekNo","toUpperCase","yyyyMmDd","dataValue","square","barGraph","unitType","units","yPositions","offsets","barsWidth","newXPos","newYPos","newOffsets","oldXPos","oldYPos","oldOffsets","lineGraph","hideLine","hideDots","valuesOverPoints","newValues","getComponent","k","assign","PercentageChart","barOptions","component","xPos","makeDataByIndex","bars","get","indexOf","gOff","pOff","formattedLabels","fraction","PieChart","mouseMove","mouseLeave","hoverRadio","startAngle","prevSlicesProperties","slicesProperties","curAngle","originDiffAngle","diffAngle","endAngle","prevProperty","curStart","curEnd","curPath","calTranslateByAngle","property","hoverSlice","flag","g_off","pageX","pageY","formatted_labels","percent","slices","prevIndex","curActiveSliceIndex","prevAcitve","curActiveSlice","normalize","mantissa","exponent","sig","exp","getChartRangeIntervals","max","min","upperBound","lowerBound","range","noOfParts","partSize","intervals","getChartIntervals","maxValue","minValue","normalMaxValue","normalMinValue","calcChartIntervals","withMinimum","getPositiveFirstIntervals","absMinValue","intervalSize","unshift","pseudoMaxValue","pseudoMinValue","getZeroIndex","yPts","zeroIndex","interval","getIntervalSize","orderedArray","getValueRange","scale","scaleMultiplier","getClosestInArray","goal","arr","closest","prev","curr","calcDistribution","distributionSize","dataMaxValue","distributionStep","distribution","checkpoint","getMaxCheckpoint","COL_WIDTH","ROW_HEIGHT","Heatmap","countLabel","validStarts","startSubDomain","startSubDomainIndex","discreteDomains","spacing","end","noOfWeeks","setFullYear","dataPoints","timestampSec$$1","firstWeekStart","domainConfigs","getDomains","lessCol","dayName","dayText","comp","daySquares","daySquare","dateParts","lessText","moreTextX","moreText","startMonth","startYear","endMonth","endYear","noOfMonths","startOfMonth","getDomainConfig","startOfWeek","domainConfig","noOfMonthWeeks","getCol","empty","currentDate","currentDateWithinData","getSubDomainConfig","dataPrep","datasetLength","zeroArray","vals","chartType","zeroDataPrep","zeroData","getShortenedLabels","chartWidth","isSeries","allowedSpace","allowedLetters","seriesMultiple","maxLabelLength","AxisChart","lineOptions","axisOptions","tooltipOptions","xAxisMode","yAxisMode","xIsSeries","shortenYAxisNumbers","formatTooltipX","formatTooltipY","calcXPositions","calcYAxisParameters","getAllYValues","unitWidth","xOffset","dataValues","intervalHeight","calcDatasetPoints","calcYExtremes","calcYRegions","scaleAll","cumulativeYs","cumulativeYPos","stacked","yExtremes","cumulative","allValueLists","barDatasets","lineDatasets","barsConfigs","spaceRatio","lineConfigs","minLine","dotSize","markerConfigs","optionals","dataUnitComponents","dataByIndex","formatX","formatY","yPos","formattedLabel","yExtreme","relX","relY","mapTooltipXPosition","dbi","overlayGuides","g","currentIndex","currentUnit","updateOverlayGuides","data_point","datasetValues","splice","updateDatasets","DonutChart","chartTypes","getChartByType","Chart","loopCounts","getPerformanceTime","func","loopCount","startTime","performance","now","endTime","buildDataSet","objectDefinePropertyFunc","proxyFunc","measuresObjectDefineProperty","measuresProxy","buildChartOptions","useObjectDefineProperty1","defineProperty","useProxy1","Proxy","useObjectDefineProperty2","newVal","useProxy2","_target","_prop","data1","data2"],"mappings":"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","file":"script.b659f85d.js","sourceRoot":"..","sourcesContent":["function $(expr, con) {\n\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n}\n\n\n\n$.create = (tag, o) => {\n\tvar element = document.createElement(tag);\n\n\tfor (var i in o) {\n\t\tvar val = o[i];\n\n\t\tif (i === \"inside\") {\n\t\t\t$(val).appendChild(element);\n\t\t}\n\t\telse if (i === \"around\") {\n\t\t\tvar ref = $(val);\n\t\t\tref.parentNode.insertBefore(element, ref);\n\t\t\telement.appendChild(ref);\n\n\t\t} else if (i === \"styles\") {\n\t\t\tif(typeof val === \"object\") {\n\t\t\t\tObject.keys(val).map(prop => {\n\t\t\t\t\telement.style[prop] = val[prop];\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (i in element ) {\n\t\t\telement[i] = val;\n\t\t}\n\t\telse {\n\t\t\telement.setAttribute(i, val);\n\t\t}\n\t}\n\n\treturn element;\n};\n\nfunction getOffset(element) {\n\tlet rect = element.getBoundingClientRect();\n\treturn {\n\t\t// https://stackoverflow.com/a/7436602/6495043\n\t\t// rect.top varies with scroll, so we add whatever has been\n\t\t// scrolled to it to get absolute distance from actual page top\n\t\ttop: rect.top + (document.documentElement.scrollTop || document.body.scrollTop),\n\t\tleft: rect.left + (document.documentElement.scrollLeft || document.body.scrollLeft)\n\t};\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetParent\n// an element's offsetParent property will return null whenever it, or any of its parents,\n// is hidden via the display style property.\nfunction isHidden(el) {\n\treturn (el.offsetParent === null);\n}\n\nfunction isElementInViewport(el) {\n\t// Although straightforward: https://stackoverflow.com/a/7557433/6495043\n\tvar rect = el.getBoundingClientRect();\n\n\treturn (\n\t\trect.top >= 0 &&\n        rect.left >= 0 &&\n        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && /*or $(window).height() */\n        rect.right <= (window.innerWidth || document.documentElement.clientWidth) /*or $(window).width() */\n\t);\n}\n\nfunction getElementContentWidth(element) {\n\tvar styles = window.getComputedStyle(element);\n\tvar padding = parseFloat(styles.paddingLeft) +\n\t\tparseFloat(styles.paddingRight);\n\n\treturn element.clientWidth - padding;\n}\n\n\n\n\n\nfunction fire(target, type, properties) {\n\tvar evt = document.createEvent(\"HTMLEvents\");\n\n\tevt.initEvent(type, true, true );\n\n\tfor (var j in properties) {\n\t\tevt[j] = properties[j];\n\t}\n\n\treturn target.dispatchEvent(evt);\n}\n\n// https://css-tricks.com/snippets/javascript/loop-queryselectorall-matches/\n\nconst BASE_MEASURES = {\n\tmargins: {\n\t\ttop: 10,\n\t\tbottom: 10,\n\t\tleft: 20,\n\t\tright: 20\n\t},\n\tpaddings: {\n\t\ttop: 20,\n\t\tbottom: 40,\n\t\tleft: 30,\n\t\tright: 10\n\t},\n\n\tbaseHeight: 240,\n\ttitleHeight: 20,\n\tlegendHeight: 30,\n\n\ttitleFontSize: 12,\n};\n\nfunction getTopOffset(m) {\n\treturn m.titleHeight + m.margins.top + m.paddings.top;\n}\n\nfunction getLeftOffset(m) {\n\treturn m.margins.left + m.paddings.left;\n}\n\nfunction getExtraHeight(m) {\n\tlet totalExtraHeight = m.margins.top + m.margins.bottom\n\t\t+ m.paddings.top + m.paddings.bottom\n\t\t+ m.titleHeight + m.legendHeight;\n\treturn totalExtraHeight;\n}\n\nfunction getExtraWidth(m) {\n\tlet totalExtraWidth = m.margins.left + m.margins.right\n\t\t+ m.paddings.left + m.paddings.right;\n\n\treturn totalExtraWidth;\n}\n\nconst INIT_CHART_UPDATE_TIMEOUT = 700;\nconst CHART_POST_ANIMATE_TIMEOUT = 400;\n\nconst DEFAULT_AXIS_CHART_TYPE = 'line';\nconst AXIS_DATASET_CHART_TYPES = ['line', 'bar'];\n\nconst AXIS_LEGEND_BAR_SIZE = 100;\n\nconst BAR_CHART_SPACE_RATIO = 0.5;\nconst MIN_BAR_PERCENT_HEIGHT = 0.00;\n\nconst LINE_CHART_DOT_SIZE = 4;\nconst DOT_OVERLAY_SIZE_INCR = 4;\n\nconst PERCENTAGE_BAR_DEFAULT_HEIGHT = 20;\nconst PERCENTAGE_BAR_DEFAULT_DEPTH = 2;\n\n// Fixed 5-color theme,\n// More colors are difficult to parse visually\nconst HEATMAP_DISTRIBUTION_SIZE = 5;\n\nconst HEATMAP_SQUARE_SIZE = 10;\nconst HEATMAP_GUTTER_SIZE = 2;\n\nconst DEFAULT_CHAR_WIDTH = 7;\n\nconst TOOLTIP_POINTER_TRIANGLE_HEIGHT = 5;\n\nconst DEFAULT_CHART_COLORS = ['light-blue', 'blue', 'violet', 'red', 'orange',\n\t'yellow', 'green', 'light-green', 'purple', 'magenta', 'light-grey', 'dark-grey'];\nconst HEATMAP_COLORS_GREEN = ['#ebedf0', '#c6e48b', '#7bc96f', '#239a3b', '#196127'];\n\n\n\nconst DEFAULT_COLORS = {\n\tbar: DEFAULT_CHART_COLORS,\n\tline: DEFAULT_CHART_COLORS,\n\tpie: DEFAULT_CHART_COLORS,\n\tpercentage: DEFAULT_CHART_COLORS,\n\theatmap: HEATMAP_COLORS_GREEN,\n\tdonut: DEFAULT_CHART_COLORS\n};\n\n// Universal constants\nconst ANGLE_RATIO = Math.PI / 180;\nconst FULL_ANGLE = 360;\n\nclass SvgTip {\n\tconstructor({\n\t\tparent = null,\n\t\tcolors = []\n\t}) {\n\t\tthis.parent = parent;\n\t\tthis.colors = colors;\n\t\tthis.titleName = '';\n\t\tthis.titleValue = '';\n\t\tthis.listValues = [];\n\t\tthis.titleValueFirst = 0;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.top = 0;\n\t\tthis.left = 0;\n\n\t\tthis.setup();\n\t}\n\n\tsetup() {\n\t\tthis.makeTooltip();\n\t}\n\n\trefresh() {\n\t\tthis.fill();\n\t\tthis.calcPosition();\n\t}\n\n\tmakeTooltip() {\n\t\tthis.container = $.create('div', {\n\t\t\tinside: this.parent,\n\t\t\tclassName: 'graph-svg-tip comparison',\n\t\t\tinnerHTML: `<span class=\"title\"></span>\n\t\t\t\t<ul class=\"data-point-list\"></ul>\n\t\t\t\t<div class=\"svg-pointer\"></div>`\n\t\t});\n\t\tthis.hideTip();\n\n\t\tthis.title = this.container.querySelector('.title');\n\t\tthis.dataPointList = this.container.querySelector('.data-point-list');\n\n\t\tthis.parent.addEventListener('mouseleave', () => {\n\t\t\tthis.hideTip();\n\t\t});\n\t}\n\n\tfill() {\n\t\tlet title;\n\t\tif(this.index) {\n\t\t\tthis.container.setAttribute('data-point-index', this.index);\n\t\t}\n\t\tif(this.titleValueFirst) {\n\t\t\ttitle = `<strong>${this.titleValue}</strong>${this.titleName}`;\n\t\t} else {\n\t\t\ttitle = `${this.titleName}<strong>${this.titleValue}</strong>`;\n\t\t}\n\t\tthis.title.innerHTML = title;\n\t\tthis.dataPointList.innerHTML = '';\n\n\t\tthis.listValues.map((set, i) => {\n\t\t\tconst color = this.colors[i] || 'black';\n\t\t\tlet value = set.formatted === 0 || set.formatted ? set.formatted : set.value;\n\n\t\t\tlet li = $.create('li', {\n\t\t\t\tstyles: {\n\t\t\t\t\t'border-top': `3px solid ${color}`\n\t\t\t\t},\n\t\t\t\tinnerHTML: `<strong style=\"display: block;\">${ value === 0 || value ? value : '' }</strong>\n\t\t\t\t\t${set.title ? set.title : '' }`\n\t\t\t});\n\n\t\t\tthis.dataPointList.appendChild(li);\n\t\t});\n\t}\n\n\tcalcPosition() {\n\t\tlet width = this.container.offsetWidth;\n\n\t\tthis.top = this.y - this.container.offsetHeight\n\t\t\t- TOOLTIP_POINTER_TRIANGLE_HEIGHT;\n\t\tthis.left = this.x - width/2;\n\t\tlet maxLeft = this.parent.offsetWidth - width;\n\n\t\tlet pointer = this.container.querySelector('.svg-pointer');\n\n\t\tif(this.left < 0) {\n\t\t\tpointer.style.left = `calc(50% - ${-1 * this.left}px)`;\n\t\t\tthis.left = 0;\n\t\t} else if(this.left > maxLeft) {\n\t\t\tlet delta = this.left - maxLeft;\n\t\t\tlet pointerOffset = `calc(50% + ${delta}px)`;\n\t\t\tpointer.style.left = pointerOffset;\n\n\t\t\tthis.left = maxLeft;\n\t\t} else {\n\t\t\tpointer.style.left = `50%`;\n\t\t}\n\t}\n\n\tsetValues(x, y, title = {}, listValues = [], index = -1) {\n\t\tthis.titleName = title.name;\n\t\tthis.titleValue = title.value;\n\t\tthis.listValues = listValues;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.titleValueFirst = title.valueFirst || 0;\n\t\tthis.index = index;\n\t\tthis.refresh();\n\t}\n\n\thideTip() {\n\t\tthis.container.style.top = '0px';\n\t\tthis.container.style.left = '0px';\n\t\tthis.container.style.opacity = '0';\n\t}\n\n\tshowTip() {\n\t\tthis.container.style.top = this.top + 'px';\n\t\tthis.container.style.left = this.left + 'px';\n\t\tthis.container.style.opacity = '1';\n\t}\n}\n\n/**\n * Returns the value of a number upto 2 decimal places.\n * @param {Number} d Any number\n */\nfunction floatTwo(d) {\n\treturn parseFloat(d.toFixed(2));\n}\n\n/**\n * Returns whether or not two given arrays are equal.\n * @param {Array} arr1 First array\n * @param {Array} arr2 Second array\n */\n\n\n/**\n * Shuffles array in place. ES6 version\n * @param {Array} array An array containing the items.\n */\n\n\n/**\n * Fill an array with extra points\n * @param {Array} array Array\n * @param {Number} count number of filler elements\n * @param {Object} element element to fill with\n * @param {Boolean} start fill at start?\n */\nfunction fillArray(array, count, element, start=false) {\n\tif(!element) {\n\t\telement = start ? array[0] : array[array.length - 1];\n\t}\n\tlet fillerArray = new Array(Math.abs(count)).fill(element);\n\tarray = start ? fillerArray.concat(array) : array.concat(fillerArray);\n\treturn array;\n}\n\n/**\n * Returns pixel width of string.\n * @param {String} string\n * @param {Number} charWidth Width of single char in pixels\n */\nfunction getStringWidth(string, charWidth) {\n\treturn (string+\"\").length * charWidth;\n}\n\n\n\n// https://stackoverflow.com/a/29325222\n\n\nfunction getPositionByAngle(angle, radius) {\n\treturn {\n\t\tx: Math.sin(angle * ANGLE_RATIO) * radius,\n\t\ty: Math.cos(angle * ANGLE_RATIO) * radius,\n\t};\n}\n\n/**\n * Check if a number is valid for svg attributes\n * @param {object} candidate Candidate to test\n * @param {Boolean} nonNegative flag to treat negative number as invalid\n */\nfunction isValidNumber(candidate, nonNegative=false) {\n\tif (Number.isNaN(candidate)) return false;\n\telse if (candidate === undefined) return false;\n\telse if (!Number.isFinite(candidate)) return false;\n\telse if (nonNegative && candidate < 0) return false;\n\telse return true;\n}\n\nfunction getBarHeightAndYAttr(yTop, zeroLine) {\n\tlet height, y;\n\tif (yTop <= zeroLine) {\n\t\theight = zeroLine - yTop;\n\t\ty = yTop;\n\t} else {\n\t\theight = yTop - zeroLine;\n\t\ty = zeroLine;\n\t}\n\n\treturn [height, y];\n}\n\nfunction equilizeNoOfElements(array1, array2,\n\textraCount = array2.length - array1.length) {\n\n\t// Doesn't work if either has zero elements.\n\tif(extraCount > 0) {\n\t\tarray1 = fillArray(array1, extraCount);\n\t} else {\n\t\tarray2 = fillArray(array2, extraCount);\n\t}\n\treturn [array1, array2];\n}\n\nfunction truncateString(txt, len) {\n\tif (!txt) {\n\t\treturn;\n\t}\n\tif (txt.length > len) {\n\t\treturn txt.slice(0, len-3) + '...';\n\t} else {\n\t\treturn txt;\n\t}\n}\n\nfunction shortenLargeNumber(label) {\n\tlet number;\n\tif (typeof label === 'number') number = label;\n\telse if (typeof label === 'string') {\n\t\tnumber = Number(label);\n\t\tif (Number.isNaN(number)) return label;\n\t}\n\n\t// Using absolute since log wont work for negative numbers\n\tlet p = Math.floor(Math.log10(Math.abs(number)));\n\tif (p <= 2) return number; // Return as is for a 3 digit number of less\n\tlet\tl = Math.floor(p / 3);\n\tlet shortened = (Math.pow(10, p - l * 3) * +(number / Math.pow(10, p)).toFixed(1));\n\n\t// Correct for floating point error upto 2 decimal places\n\treturn Math.round(shortened*100)/100 + ' ' + ['', 'K', 'M', 'B', 'T'][l];\n}\n\n// cubic bezier curve calculation (from example by François Romain)\nfunction getSplineCurvePointsStr(xList, yList) {\n\n\tlet points=[];\n\tfor(let i=0;i<xList.length;i++){\n\t\tpoints.push([xList[i], yList[i]]);\n\t}\n\n\tlet smoothing = 0.2;\n\tlet line = (pointA, pointB) => {\n\t\tlet lengthX = pointB[0] - pointA[0];\n\t\tlet lengthY = pointB[1] - pointA[1];\n\t\treturn {\n\t\t\tlength: Math.sqrt(Math.pow(lengthX, 2) + Math.pow(lengthY, 2)),\n\t\t\tangle: Math.atan2(lengthY, lengthX)\n\t\t};\n\t};\n    \n\tlet controlPoint = (current, previous, next, reverse) => {\n\t\tlet p = previous || current;\n\t\tlet n = next || current;\n\t\tlet o = line(p, n);\n\t\tlet angle = o.angle + (reverse ? Math.PI : 0);\n\t\tlet length = o.length * smoothing;\n\t\tlet x = current[0] + Math.cos(angle) * length;\n\t\tlet y = current[1] + Math.sin(angle) * length;\n\t\treturn [x, y];\n\t};\n    \n\tlet bezierCommand = (point, i, a) => {\n\t\tlet cps = controlPoint(a[i - 1], a[i - 2], point);\n\t\tlet cpe = controlPoint(point, a[i - 1], a[i + 1], true);\n\t\treturn `C ${cps[0]},${cps[1]} ${cpe[0]},${cpe[1]} ${point[0]},${point[1]}`;\n\t};\n    \n\tlet pointStr = (points, command) => {\n\t\treturn points.reduce((acc, point, i, a) => i === 0\n\t\t\t? `${point[0]},${point[1]}`\n\t\t\t: `${acc} ${command(point, i, a)}`, '');\n\t};\n    \n\treturn pointStr(points, bezierCommand);\n}\n\nconst PRESET_COLOR_MAP = {\n\t'light-blue': '#7cd6fd',\n\t'blue': '#5e64ff',\n\t'violet': '#743ee2',\n\t'red': '#ff5858',\n\t'orange': '#ffa00a',\n\t'yellow': '#feef72',\n\t'green': '#28a745',\n\t'light-green': '#98d85b',\n\t'purple': '#b554ff',\n\t'magenta': '#ffa3ef',\n\t'black': '#36114C',\n\t'grey': '#bdd3e6',\n\t'light-grey': '#f0f4f7',\n\t'dark-grey': '#b8c2cc'\n};\n\nfunction limitColor(r){\n\tif (r > 255) return 255;\n\telse if (r < 0) return 0;\n\treturn r;\n}\n\nfunction lightenDarkenColor(color, amt) {\n\tlet col = getColor(color);\n\tlet usePound = false;\n\tif (col[0] == \"#\") {\n\t\tcol = col.slice(1);\n\t\tusePound = true;\n\t}\n\tlet num = parseInt(col,16);\n\tlet r = limitColor((num >> 16) + amt);\n\tlet b = limitColor(((num >> 8) & 0x00FF) + amt);\n\tlet g = limitColor((num & 0x0000FF) + amt);\n\treturn (usePound?\"#\":\"\") + (g | (b << 8) | (r << 16)).toString(16);\n}\n\nfunction isValidColor(string) {\n\t// https://stackoverflow.com/a/32685393\n\tlet HEX_RE = /(^\\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i;\n\tlet RGB_RE = /(^\\s*)(rgb|hsl)(a?)[(]\\s*([\\d.]+\\s*%?)\\s*,\\s*([\\d.]+\\s*%?)\\s*,\\s*([\\d.]+\\s*%?)\\s*(?:,\\s*([\\d.]+)\\s*)?[)]$/i;\n\treturn HEX_RE.test(string) || RGB_RE.test(string);\n}\n\nconst getColor = (color) => {\n\treturn PRESET_COLOR_MAP[color] || color;\n};\n\nconst AXIS_TICK_LENGTH = 6;\nconst LABEL_MARGIN = 4;\nconst LABEL_MAX_CHARS = 15;\nconst FONT_SIZE = 10;\nconst BASE_LINE_COLOR = '#dadada';\nconst FONT_FILL = '#555b51';\n\nfunction $$1(expr, con) {\n\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n}\n\nfunction createSVG(tag, o) {\n\tvar element = document.createElementNS(\"http://www.w3.org/2000/svg\", tag);\n\n\tfor (var i in o) {\n\t\tvar val = o[i];\n\n\t\tif (i === \"inside\") {\n\t\t\t$$1(val).appendChild(element);\n\t\t}\n\t\telse if (i === \"around\") {\n\t\t\tvar ref = $$1(val);\n\t\t\tref.parentNode.insertBefore(element, ref);\n\t\t\telement.appendChild(ref);\n\n\t\t} else if (i === \"styles\") {\n\t\t\tif(typeof val === \"object\") {\n\t\t\t\tObject.keys(val).map(prop => {\n\t\t\t\t\telement.style[prop] = val[prop];\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif(i === \"className\") { i = \"class\"; }\n\t\t\tif(i === \"innerHTML\") {\n\t\t\t\telement['textContent'] = val;\n\t\t\t} else {\n\t\t\t\telement.setAttribute(i, val);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn element;\n}\n\nfunction renderVerticalGradient(svgDefElem, gradientId) {\n\treturn createSVG('linearGradient', {\n\t\tinside: svgDefElem,\n\t\tid: gradientId,\n\t\tx1: 0,\n\t\tx2: 0,\n\t\ty1: 0,\n\t\ty2: 1\n\t});\n}\n\nfunction setGradientStop(gradElem, offset, color, opacity) {\n\treturn createSVG('stop', {\n\t\t'inside': gradElem,\n\t\t'style': `stop-color: ${color}`,\n\t\t'offset': offset,\n\t\t'stop-opacity': opacity\n\t});\n}\n\nfunction makeSVGContainer(parent, className, width, height) {\n\treturn createSVG('svg', {\n\t\tclassName: className,\n\t\tinside: parent,\n\t\twidth: width,\n\t\theight: height\n\t});\n}\n\nfunction makeSVGDefs(svgContainer) {\n\treturn createSVG('defs', {\n\t\tinside: svgContainer,\n\t});\n}\n\nfunction makeSVGGroup(className, transform='', parent=undefined) {\n\tlet args = {\n\t\tclassName: className,\n\t\ttransform: transform\n\t};\n\tif(parent) args.inside = parent;\n\treturn createSVG('g', args);\n}\n\n\n\nfunction makePath(pathStr, className='', stroke='none', fill='none', strokeWidth=2) {\n\treturn createSVG('path', {\n\t\tclassName: className,\n\t\td: pathStr,\n\t\tstyles: {\n\t\t\tstroke: stroke,\n\t\t\tfill: fill,\n\t\t\t'stroke-width': strokeWidth\n\t\t}\n\t});\n}\n\nfunction makeArcPathStr(startPosition, endPosition, center, radius, clockWise=1, largeArc=0){\n\tlet [arcStartX, arcStartY] = [center.x + startPosition.x, center.y + startPosition.y];\n\tlet [arcEndX, arcEndY] = [center.x + endPosition.x, center.y + endPosition.y];\n\treturn `M${center.x} ${center.y}\n\t\tL${arcStartX} ${arcStartY}\n\t\tA ${radius} ${radius} 0 ${largeArc} ${clockWise ? 1 : 0}\n\t\t${arcEndX} ${arcEndY} z`;\n}\n\nfunction makeCircleStr(startPosition, endPosition, center, radius, clockWise=1, largeArc=0){\n\tlet [arcStartX, arcStartY] = [center.x + startPosition.x, center.y + startPosition.y];\n\tlet [arcEndX, midArc, arcEndY] = [center.x + endPosition.x, center.y * 2, center.y + endPosition.y];\n\treturn `M${center.x} ${center.y}\n\t\tL${arcStartX} ${arcStartY}\n\t\tA ${radius} ${radius} 0 ${largeArc} ${clockWise ? 1 : 0}\n\t\t${arcEndX} ${midArc} z\n\t\tL${arcStartX} ${midArc}\n\t\tA ${radius} ${radius} 0 ${largeArc} ${clockWise ? 1 : 0}\n\t\t${arcEndX} ${arcEndY} z`;\n}\n\nfunction makeArcStrokePathStr(startPosition, endPosition, center, radius, clockWise=1, largeArc=0){\n\tlet [arcStartX, arcStartY] = [center.x + startPosition.x, center.y + startPosition.y];\n\tlet [arcEndX, arcEndY] = [center.x + endPosition.x, center.y + endPosition.y];\n\n\treturn `M${arcStartX} ${arcStartY}\n\t\tA ${radius} ${radius} 0 ${largeArc} ${clockWise ? 1 : 0}\n\t\t${arcEndX} ${arcEndY}`;\n}\n\nfunction makeStrokeCircleStr(startPosition, endPosition, center, radius, clockWise=1, largeArc=0){\n\tlet [arcStartX, arcStartY] = [center.x + startPosition.x, center.y + startPosition.y];\n\tlet [arcEndX, midArc, arcEndY] = [center.x + endPosition.x, radius * 2 + arcStartY, center.y + startPosition.y];\n\n\treturn `M${arcStartX} ${arcStartY}\n\t\tA ${radius} ${radius} 0 ${largeArc} ${clockWise ? 1 : 0}\n\t\t${arcEndX} ${midArc}\n\t\tM${arcStartX} ${midArc}\n\t\tA ${radius} ${radius} 0 ${largeArc} ${clockWise ? 1 : 0}\n\t\t${arcEndX} ${arcEndY}`;\n}\n\nfunction makeGradient(svgDefElem, color, lighter = false) {\n\tlet gradientId ='path-fill-gradient' + '-' + color + '-' +(lighter ? 'lighter' : 'default');\n\tlet gradientDef = renderVerticalGradient(svgDefElem, gradientId);\n\tlet opacities = [1, 0.6, 0.2];\n\tif(lighter) {\n\t\topacities = [0.4, 0.2, 0];\n\t}\n\n\tsetGradientStop(gradientDef, \"0%\", color, opacities[0]);\n\tsetGradientStop(gradientDef, \"50%\", color, opacities[1]);\n\tsetGradientStop(gradientDef, \"100%\", color, opacities[2]);\n\n\treturn gradientId;\n}\n\nfunction percentageBar(x, y, width, height,\n\tdepth=PERCENTAGE_BAR_DEFAULT_DEPTH, fill='none') {\n\n\tlet args = {\n\t\tclassName: 'percentage-bar',\n\t\tx: x,\n\t\ty: y,\n\t\twidth: width,\n\t\theight: height,\n\t\tfill: fill,\n\t\tstyles: {\n\t\t\t'stroke': lightenDarkenColor(fill, -25),\n\t\t\t// Diabolically good: https://stackoverflow.com/a/9000859\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray\n\t\t\t'stroke-dasharray': `0, ${height + width}, ${width}, ${height}`,\n\t\t\t'stroke-width': depth\n\t\t},\n\t};\n\n\treturn createSVG(\"rect\", args);\n}\n\nfunction heatSquare(className, x, y, size, radius, fill='none', data={}) {\n\tlet args = {\n\t\tclassName: className,\n\t\tx: x,\n\t\ty: y,\n\t\twidth: size,\n\t\theight: size,\n\t\trx: radius,\n\t\tfill: fill\n\t};\n\n\tObject.keys(data).map(key => {\n\t\targs[key] = data[key];\n\t});\n\n\treturn createSVG(\"rect\", args);\n}\n\nfunction legendBar(x, y, size, fill='none', label, truncate=false) {\n\tlabel = truncate ? truncateString(label, LABEL_MAX_CHARS) : label;\n\n\tlet args = {\n\t\tclassName: 'legend-bar',\n\t\tx: 0,\n\t\ty: 0,\n\t\twidth: size,\n\t\theight: '2px',\n\t\tfill: fill\n\t};\n\tlet text = createSVG('text', {\n\t\tclassName: 'legend-dataset-text',\n\t\tx: 0,\n\t\ty: 0,\n\t\tdy: (FONT_SIZE * 2) + 'px',\n\t\t'font-size': (FONT_SIZE * 1.2) + 'px',\n\t\t'text-anchor': 'start',\n\t\tfill: FONT_FILL,\n\t\tinnerHTML: label\n\t});\n\n\tlet group = createSVG('g', {\n\t\ttransform: `translate(${x}, ${y})`\n\t});\n\tgroup.appendChild(createSVG(\"rect\", args));\n\tgroup.appendChild(text);\n\n\treturn group;\n}\n\nfunction legendDot(x, y, size, fill='none', label, truncate=false) {\n\tlabel = truncate ? truncateString(label, LABEL_MAX_CHARS) : label;\n\n\tlet args = {\n\t\tclassName: 'legend-dot',\n\t\tcx: 0,\n\t\tcy: 0,\n\t\tr: size,\n\t\tfill: fill\n\t};\n\tlet text = createSVG('text', {\n\t\tclassName: 'legend-dataset-text',\n\t\tx: 0,\n\t\ty: 0,\n\t\tdx: (FONT_SIZE) + 'px',\n\t\tdy: (FONT_SIZE/3) + 'px',\n\t\t'font-size': (FONT_SIZE * 1.2) + 'px',\n\t\t'text-anchor': 'start',\n\t\tfill: FONT_FILL,\n\t\tinnerHTML: label\n\t});\n\n\tlet group = createSVG('g', {\n\t\ttransform: `translate(${x}, ${y})`\n\t});\n\tgroup.appendChild(createSVG(\"circle\", args));\n\tgroup.appendChild(text);\n\n\treturn group;\n}\n\nfunction makeText(className, x, y, content, options = {}) {\n\tlet fontSize = options.fontSize || FONT_SIZE;\n\tlet dy = options.dy !== undefined ? options.dy : (fontSize / 2);\n\tlet fill = options.fill || FONT_FILL;\n\tlet textAnchor = options.textAnchor || 'start';\n\treturn createSVG('text', {\n\t\tclassName: className,\n\t\tx: x,\n\t\ty: y,\n\t\tdy: dy + 'px',\n\t\t'font-size': fontSize + 'px',\n\t\tfill: fill,\n\t\t'text-anchor': textAnchor,\n\t\tinnerHTML: content\n\t});\n}\n\nfunction makeVertLine(x, label, y1, y2, options={}) {\n\tif(!options.stroke) options.stroke = BASE_LINE_COLOR;\n\tlet l = createSVG('line', {\n\t\tclassName: 'line-vertical ' + options.className,\n\t\tx1: 0,\n\t\tx2: 0,\n\t\ty1: y1,\n\t\ty2: y2,\n\t\tstyles: {\n\t\t\tstroke: options.stroke\n\t\t}\n\t});\n\n\tlet text = createSVG('text', {\n\t\tx: 0,\n\t\ty: y1 > y2 ? y1 + LABEL_MARGIN : y1 - LABEL_MARGIN - FONT_SIZE,\n\t\tdy: FONT_SIZE + 'px',\n\t\t'font-size': FONT_SIZE + 'px',\n\t\t'text-anchor': 'middle',\n\t\tinnerHTML: label + \"\"\n\t});\n\n\tlet line = createSVG('g', {\n\t\ttransform: `translate(${ x }, 0)`\n\t});\n\n\tline.appendChild(l);\n\tline.appendChild(text);\n\n\treturn line;\n}\n\nfunction makeHoriLine(y, label, x1, x2, options={}) {\n\tif(!options.stroke) options.stroke = BASE_LINE_COLOR;\n\tif(!options.lineType) options.lineType = '';\n\tif (options.shortenNumbers) label = shortenLargeNumber(label);\n\n\tlet className = 'line-horizontal ' + options.className +\n\t\t(options.lineType === \"dashed\" ? \"dashed\": \"\");\n\n\tlet l = createSVG('line', {\n\t\tclassName: className,\n\t\tx1: x1,\n\t\tx2: x2,\n\t\ty1: 0,\n\t\ty2: 0,\n\t\tstyles: {\n\t\t\tstroke: options.stroke\n\t\t}\n\t});\n\n\tlet text = createSVG('text', {\n\t\tx: x1 < x2 ? x1 - LABEL_MARGIN : x1 + LABEL_MARGIN,\n\t\ty: 0,\n\t\tdy: (FONT_SIZE / 2 - 2) + 'px',\n\t\t'font-size': FONT_SIZE + 'px',\n\t\t'text-anchor': x1 < x2 ? 'end' : 'start',\n\t\tinnerHTML: label+\"\"\n\t});\n\n\tlet line = createSVG('g', {\n\t\ttransform: `translate(0, ${y})`,\n\t\t'stroke-opacity': 1\n\t});\n\n\tif(text === 0 || text === '0') {\n\t\tline.style.stroke = \"rgba(27, 31, 35, 0.6)\";\n\t}\n\n\tline.appendChild(l);\n\tline.appendChild(text);\n\n\treturn line;\n}\n\nfunction yLine(y, label, width, options={}) {\n\tif (!isValidNumber(y)) y = 0;\n\n\tif(!options.pos) options.pos = 'left';\n\tif(!options.offset) options.offset = 0;\n\tif(!options.mode) options.mode = 'span';\n\tif(!options.stroke) options.stroke = BASE_LINE_COLOR;\n\tif(!options.className) options.className = '';\n\n\tlet x1 = -1 * AXIS_TICK_LENGTH;\n\tlet x2 = options.mode === 'span' ? width + AXIS_TICK_LENGTH : 0;\n\n\tif(options.mode === 'tick' && options.pos === 'right') {\n\t\tx1 = width + AXIS_TICK_LENGTH;\n\t\tx2 = width;\n\t}\n\n\t// let offset = options.pos === 'left' ? -1 * options.offset : options.offset;\n\n\tx1 += options.offset;\n\tx2 += options.offset;\n\n\treturn makeHoriLine(y, label, x1, x2, {\n\t\tstroke: options.stroke,\n\t\tclassName: options.className,\n\t\tlineType: options.lineType,\n\t\tshortenNumbers: options.shortenNumbers\n\t});\n}\n\nfunction xLine(x, label, height, options={}) {\n\tif (!isValidNumber(x)) x = 0;\n\n\tif(!options.pos) options.pos = 'bottom';\n\tif(!options.offset) options.offset = 0;\n\tif(!options.mode) options.mode = 'span';\n\tif(!options.stroke) options.stroke = BASE_LINE_COLOR;\n\tif(!options.className) options.className = '';\n\n\t// Draw X axis line in span/tick mode with optional label\n\t//                        \ty2(span)\n\t// \t\t\t\t\t\t|\n\t// \t\t\t\t\t\t|\n\t//\t\t\t\tx line\t|\n\t//\t\t\t\t\t\t|\n\t// \t\t\t\t\t   \t|\n\t// ---------------------+-- y2(tick)\n\t//\t\t\t\t\t\t|\n\t//\t\t\t\t\t\t\ty1\n\n\tlet y1 = height + AXIS_TICK_LENGTH;\n\tlet y2 = options.mode === 'span' ? -1 * AXIS_TICK_LENGTH : height;\n\n\tif(options.mode === 'tick' && options.pos === 'top') {\n\t\t// top axis ticks\n\t\ty1 = -1 * AXIS_TICK_LENGTH;\n\t\ty2 = 0;\n\t}\n\n\treturn makeVertLine(x, label, y1, y2, {\n\t\tstroke: options.stroke,\n\t\tclassName: options.className,\n\t\tlineType: options.lineType\n\t});\n}\n\nfunction yMarker(y, label, width, options={}) {\n\tif(!options.labelPos) options.labelPos = 'right';\n\tlet x = options.labelPos === 'left' ? LABEL_MARGIN\n\t\t: width - getStringWidth(label, 5) - LABEL_MARGIN;\n\n\tlet labelSvg = createSVG('text', {\n\t\tclassName: 'chart-label',\n\t\tx: x,\n\t\ty: 0,\n\t\tdy: (FONT_SIZE / -2) + 'px',\n\t\t'font-size': FONT_SIZE + 'px',\n\t\t'text-anchor': 'start',\n\t\tinnerHTML: label+\"\"\n\t});\n\n\tlet line = makeHoriLine(y, '', 0, width, {\n\t\tstroke: options.stroke || BASE_LINE_COLOR,\n\t\tclassName: options.className || '',\n\t\tlineType: options.lineType\n\t});\n\n\tline.appendChild(labelSvg);\n\n\treturn line;\n}\n\nfunction yRegion(y1, y2, width, label, options={}) {\n\t// return a group\n\tlet height = y1 - y2;\n\n\tlet rect = createSVG('rect', {\n\t\tclassName: `bar mini`, // remove class\n\t\tstyles: {\n\t\t\tfill: `rgba(228, 234, 239, 0.49)`,\n\t\t\tstroke: BASE_LINE_COLOR,\n\t\t\t'stroke-dasharray': `${width}, ${height}`\n\t\t},\n\t\t// 'data-point-index': index,\n\t\tx: 0,\n\t\ty: 0,\n\t\twidth: width,\n\t\theight: height\n\t});\n\n\tif(!options.labelPos) options.labelPos = 'right';\n\tlet x = options.labelPos === 'left' ? LABEL_MARGIN\n\t\t: width - getStringWidth(label+\"\", 4.5) - LABEL_MARGIN;\n\n\tlet labelSvg = createSVG('text', {\n\t\tclassName: 'chart-label',\n\t\tx: x,\n\t\ty: 0,\n\t\tdy: (FONT_SIZE / -2) + 'px',\n\t\t'font-size': FONT_SIZE + 'px',\n\t\t'text-anchor': 'start',\n\t\tinnerHTML: label+\"\"\n\t});\n\n\tlet region = createSVG('g', {\n\t\ttransform: `translate(0, ${y2})`\n\t});\n\n\tregion.appendChild(rect);\n\tregion.appendChild(labelSvg);\n\n\treturn region;\n}\n\nfunction datasetBar(x, yTop, width, color, label='', index=0, offset=0, meta={}) {\n\tlet [height, y] = getBarHeightAndYAttr(yTop, meta.zeroLine);\n\ty -= offset;\n\n\tif(height === 0) {\n\t\theight = meta.minHeight;\n\t\ty -= meta.minHeight;\n\t}\n\n\t// Preprocess numbers to avoid svg building errors\n\tif (!isValidNumber(x)) x = 0;\n\tif (!isValidNumber(y)) y = 0;\n\tif (!isValidNumber(height, true)) height = 0;\n\tif (!isValidNumber(width, true)) width = 0;\n\n\tlet rect = createSVG('rect', {\n\t\tclassName: `bar mini`,\n\t\tstyle: `fill: ${color}`,\n\t\t'data-point-index': index,\n\t\tx: x,\n\t\ty: y,\n\t\twidth: width,\n\t\theight: height\n\t});\n\n\tlabel += \"\";\n\n\tif(!label && !label.length) {\n\t\treturn rect;\n\t} else {\n\t\trect.setAttribute('y', 0);\n\t\trect.setAttribute('x', 0);\n\t\tlet text = createSVG('text', {\n\t\t\tclassName: 'data-point-value',\n\t\t\tx: width/2,\n\t\t\ty: 0,\n\t\t\tdy: (FONT_SIZE / 2 * -1) + 'px',\n\t\t\t'font-size': FONT_SIZE + 'px',\n\t\t\t'text-anchor': 'middle',\n\t\t\tinnerHTML: label\n\t\t});\n\n\t\tlet group = createSVG('g', {\n\t\t\t'data-point-index': index,\n\t\t\ttransform: `translate(${x}, ${y})`\n\t\t});\n\t\tgroup.appendChild(rect);\n\t\tgroup.appendChild(text);\n\n\t\treturn group;\n\t}\n}\n\nfunction datasetDot(x, y, radius, color, label='', index=0) {\n\tlet dot = createSVG('circle', {\n\t\tstyle: `fill: ${color}`,\n\t\t'data-point-index': index,\n\t\tcx: x,\n\t\tcy: y,\n\t\tr: radius\n\t});\n\n\tlabel += \"\";\n\n\tif(!label && !label.length) {\n\t\treturn dot;\n\t} else {\n\t\tdot.setAttribute('cy', 0);\n\t\tdot.setAttribute('cx', 0);\n\n\t\tlet text = createSVG('text', {\n\t\t\tclassName: 'data-point-value',\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tdy: (FONT_SIZE / 2 * -1 - radius) + 'px',\n\t\t\t'font-size': FONT_SIZE + 'px',\n\t\t\t'text-anchor': 'middle',\n\t\t\tinnerHTML: label\n\t\t});\n\n\t\tlet group = createSVG('g', {\n\t\t\t'data-point-index': index,\n\t\t\ttransform: `translate(${x}, ${y})`\n\t\t});\n\t\tgroup.appendChild(dot);\n\t\tgroup.appendChild(text);\n\n\t\treturn group;\n\t}\n}\n\nfunction getPaths(xList, yList, color, options={}, meta={}) {\n\tlet pointsList = yList.map((y, i) => (xList[i] + ',' + y));\n\tlet pointsStr = pointsList.join(\"L\");\n\n\t// Spline\n\tif (options.spline)\n\t\tpointsStr = getSplineCurvePointsStr(xList, yList);\n\n\tlet path = makePath(\"M\"+pointsStr, 'line-graph-path', color);\n\n\t// HeatLine\n\tif(options.heatline) {\n\t\tlet gradient_id = makeGradient(meta.svgDefs, color);\n\t\tpath.style.stroke = `url(#${gradient_id})`;\n\t}\n\n\tlet paths = {\n\t\tpath: path\n\t};\n\n\t// Region\n\tif(options.regionFill) {\n\t\tlet gradient_id_region = makeGradient(meta.svgDefs, color, true);\n\n\t\tlet pathStr = \"M\" + `${xList[0]},${meta.zeroLine}L` + pointsStr + `L${xList.slice(-1)[0]},${meta.zeroLine}`;\n\t\tpaths.region = makePath(pathStr, `region-fill`, 'none', `url(#${gradient_id_region})`);\n\t}\n\n\treturn paths;\n}\n\nlet makeOverlay = {\n\t'bar': (unit) => {\n\t\tlet transformValue;\n\t\tif(unit.nodeName !== 'rect') {\n\t\t\ttransformValue = unit.getAttribute('transform');\n\t\t\tunit = unit.childNodes[0];\n\t\t}\n\t\tlet overlay = unit.cloneNode();\n\t\toverlay.style.fill = '#000000';\n\t\toverlay.style.opacity = '0.4';\n\n\t\tif(transformValue) {\n\t\t\toverlay.setAttribute('transform', transformValue);\n\t\t}\n\t\treturn overlay;\n\t},\n\n\t'dot': (unit) => {\n\t\tlet transformValue;\n\t\tif(unit.nodeName !== 'circle') {\n\t\t\ttransformValue = unit.getAttribute('transform');\n\t\t\tunit = unit.childNodes[0];\n\t\t}\n\t\tlet overlay = unit.cloneNode();\n\t\tlet radius = unit.getAttribute('r');\n\t\tlet fill = unit.getAttribute('fill');\n\t\toverlay.setAttribute('r', parseInt(radius) + DOT_OVERLAY_SIZE_INCR);\n\t\toverlay.setAttribute('fill', fill);\n\t\toverlay.style.opacity = '0.6';\n\n\t\tif(transformValue) {\n\t\t\toverlay.setAttribute('transform', transformValue);\n\t\t}\n\t\treturn overlay;\n\t},\n\n\t'heat_square': (unit) => {\n\t\tlet transformValue;\n\t\tif(unit.nodeName !== 'circle') {\n\t\t\ttransformValue = unit.getAttribute('transform');\n\t\t\tunit = unit.childNodes[0];\n\t\t}\n\t\tlet overlay = unit.cloneNode();\n\t\tlet radius = unit.getAttribute('r');\n\t\tlet fill = unit.getAttribute('fill');\n\t\toverlay.setAttribute('r', parseInt(radius) + DOT_OVERLAY_SIZE_INCR);\n\t\toverlay.setAttribute('fill', fill);\n\t\toverlay.style.opacity = '0.6';\n\n\t\tif(transformValue) {\n\t\t\toverlay.setAttribute('transform', transformValue);\n\t\t}\n\t\treturn overlay;\n\t}\n};\n\nlet updateOverlay = {\n\t'bar': (unit, overlay) => {\n\t\tlet transformValue;\n\t\tif(unit.nodeName !== 'rect') {\n\t\t\ttransformValue = unit.getAttribute('transform');\n\t\t\tunit = unit.childNodes[0];\n\t\t}\n\t\tlet attributes = ['x', 'y', 'width', 'height'];\n\t\tObject.values(unit.attributes)\n\t\t\t.filter(attr => attributes.includes(attr.name) && attr.specified)\n\t\t\t.map(attr => {\n\t\t\t\toverlay.setAttribute(attr.name, attr.nodeValue);\n\t\t\t});\n\n\t\tif(transformValue) {\n\t\t\toverlay.setAttribute('transform', transformValue);\n\t\t}\n\t},\n\n\t'dot': (unit, overlay) => {\n\t\tlet transformValue;\n\t\tif(unit.nodeName !== 'circle') {\n\t\t\ttransformValue = unit.getAttribute('transform');\n\t\t\tunit = unit.childNodes[0];\n\t\t}\n\t\tlet attributes = ['cx', 'cy'];\n\t\tObject.values(unit.attributes)\n\t\t\t.filter(attr => attributes.includes(attr.name) && attr.specified)\n\t\t\t.map(attr => {\n\t\t\t\toverlay.setAttribute(attr.name, attr.nodeValue);\n\t\t\t});\n\n\t\tif(transformValue) {\n\t\t\toverlay.setAttribute('transform', transformValue);\n\t\t}\n\t},\n\n\t'heat_square': (unit, overlay) => {\n\t\tlet transformValue;\n\t\tif(unit.nodeName !== 'circle') {\n\t\t\ttransformValue = unit.getAttribute('transform');\n\t\t\tunit = unit.childNodes[0];\n\t\t}\n\t\tlet attributes = ['cx', 'cy'];\n\t\tObject.values(unit.attributes)\n\t\t\t.filter(attr => attributes.includes(attr.name) && attr.specified)\n\t\t\t.map(attr => {\n\t\t\t\toverlay.setAttribute(attr.name, attr.nodeValue);\n\t\t\t});\n\n\t\tif(transformValue) {\n\t\t\toverlay.setAttribute('transform', transformValue);\n\t\t}\n\t},\n};\n\nconst UNIT_ANIM_DUR = 350;\nconst PATH_ANIM_DUR = 350;\nconst MARKER_LINE_ANIM_DUR = UNIT_ANIM_DUR;\nconst REPLACE_ALL_NEW_DUR = 250;\n\nconst STD_EASING = 'easein';\n\nfunction translate(unit, oldCoord, newCoord, duration) {\n\tlet old = typeof oldCoord === 'string' ? oldCoord : oldCoord.join(', ');\n\treturn [\n\t\tunit,\n\t\t{transform: newCoord.join(', ')},\n\t\tduration,\n\t\tSTD_EASING,\n\t\t\"translate\",\n\t\t{transform: old}\n\t];\n}\n\nfunction translateVertLine(xLine, newX, oldX) {\n\treturn translate(xLine, [oldX, 0], [newX, 0], MARKER_LINE_ANIM_DUR);\n}\n\nfunction translateHoriLine(yLine, newY, oldY) {\n\treturn translate(yLine, [0, oldY], [0, newY], MARKER_LINE_ANIM_DUR);\n}\n\nfunction animateRegion(rectGroup, newY1, newY2, oldY2) {\n\tlet newHeight = newY1 - newY2;\n\tlet rect = rectGroup.childNodes[0];\n\tlet width = rect.getAttribute(\"width\");\n\tlet rectAnim = [\n\t\trect,\n\t\t{ height: newHeight, 'stroke-dasharray': `${width}, ${newHeight}` },\n\t\tMARKER_LINE_ANIM_DUR,\n\t\tSTD_EASING\n\t];\n\n\tlet groupAnim = translate(rectGroup, [0, oldY2], [0, newY2], MARKER_LINE_ANIM_DUR);\n\treturn [rectAnim, groupAnim];\n}\n\nfunction animateBar(bar, x, yTop, width, offset=0, meta={}) {\n\tlet [height, y] = getBarHeightAndYAttr(yTop, meta.zeroLine);\n\ty -= offset;\n\tif(bar.nodeName !== 'rect') {\n\t\tlet rect = bar.childNodes[0];\n\t\tlet rectAnim = [\n\t\t\trect,\n\t\t\t{width: width, height: height},\n\t\t\tUNIT_ANIM_DUR,\n\t\t\tSTD_EASING\n\t\t];\n\n\t\tlet oldCoordStr = bar.getAttribute(\"transform\").split(\"(\")[1].slice(0, -1);\n\t\tlet groupAnim = translate(bar, oldCoordStr, [x, y], MARKER_LINE_ANIM_DUR);\n\t\treturn [rectAnim, groupAnim];\n\t} else {\n\t\treturn [[bar, {width: width, height: height, x: x, y: y}, UNIT_ANIM_DUR, STD_EASING]];\n\t}\n\t// bar.animate({height: args.newHeight, y: yTop}, UNIT_ANIM_DUR, mina.easein);\n}\n\nfunction animateDot(dot, x, y) {\n\tif(dot.nodeName !== 'circle') {\n\t\tlet oldCoordStr = dot.getAttribute(\"transform\").split(\"(\")[1].slice(0, -1);\n\t\tlet groupAnim = translate(dot, oldCoordStr, [x, y], MARKER_LINE_ANIM_DUR);\n\t\treturn [groupAnim];\n\t} else {\n\t\treturn [[dot, {cx: x, cy: y}, UNIT_ANIM_DUR, STD_EASING]];\n\t}\n\t// dot.animate({cy: yTop}, UNIT_ANIM_DUR, mina.easein);\n}\n\nfunction animatePath(paths, newXList, newYList, zeroLine, spline) {\n\tlet pathComponents = [];\n\tlet pointsStr = newYList.map((y, i) => (newXList[i] + ',' + y)).join(\"L\");\n\n\tif (spline)\n\t\tpointsStr = getSplineCurvePointsStr(newXList, newYList);\n\n\tconst animPath = [paths.path, {d:\"M\" + pointsStr}, PATH_ANIM_DUR, STD_EASING];\n\tpathComponents.push(animPath);\n\n\tif(paths.region) {\n\t\tlet regStartPt = `${newXList[0]},${zeroLine}L`;\n\t\tlet regEndPt = `L${newXList.slice(-1)[0]}, ${zeroLine}`;\n\n\t\tconst animRegion = [\n\t\t\tpaths.region,\n\t\t\t{d:\"M\" + regStartPt + pointsStr + regEndPt},\n\t\t\tPATH_ANIM_DUR,\n\t\t\tSTD_EASING\n\t\t];\n\t\tpathComponents.push(animRegion);\n\t}\n\n\treturn pathComponents;\n}\n\nfunction animatePathStr(oldPath, pathStr) {\n\treturn [oldPath, {d: pathStr}, UNIT_ANIM_DUR, STD_EASING];\n}\n\n// Leveraging SMIL Animations\n\nconst EASING = {\n\tease: \"0.25 0.1 0.25 1\",\n\tlinear: \"0 0 1 1\",\n\t// easein: \"0.42 0 1 1\",\n\teasein: \"0.1 0.8 0.2 1\",\n\teaseout: \"0 0 0.58 1\",\n\teaseinout: \"0.42 0 0.58 1\"\n};\n\nfunction animateSVGElement(element, props, dur, easingType=\"linear\", type=undefined, oldValues={}) {\n\n\tlet animElement = element.cloneNode(true);\n\tlet newElement = element.cloneNode(true);\n\n\tfor(var attributeName in props) {\n\t\tlet animateElement;\n\t\tif(attributeName === 'transform') {\n\t\t\tanimateElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"animateTransform\");\n\t\t} else {\n\t\t\tanimateElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"animate\");\n\t\t}\n\t\tlet currentValue = oldValues[attributeName] || element.getAttribute(attributeName);\n\t\tlet value = props[attributeName];\n\n\t\tlet animAttr = {\n\t\t\tattributeName: attributeName,\n\t\t\tfrom: currentValue,\n\t\t\tto: value,\n\t\t\tbegin: \"0s\",\n\t\t\tdur: dur/1000 + \"s\",\n\t\t\tvalues: currentValue + \";\" + value,\n\t\t\tkeySplines: EASING[easingType],\n\t\t\tkeyTimes: \"0;1\",\n\t\t\tcalcMode: \"spline\",\n\t\t\tfill: 'freeze'\n\t\t};\n\n\t\tif(type) {\n\t\t\tanimAttr[\"type\"] = type;\n\t\t}\n\n\t\tfor (var i in animAttr) {\n\t\t\tanimateElement.setAttribute(i, animAttr[i]);\n\t\t}\n\n\t\tanimElement.appendChild(animateElement);\n\n\t\tif(type) {\n\t\t\tnewElement.setAttribute(attributeName, `translate(${value})`);\n\t\t} else {\n\t\t\tnewElement.setAttribute(attributeName, value);\n\t\t}\n\t}\n\n\treturn [animElement, newElement];\n}\n\nfunction transform(element, style) { // eslint-disable-line no-unused-vars\n\telement.style.transform = style;\n\telement.style.webkitTransform = style;\n\telement.style.msTransform = style;\n\telement.style.mozTransform = style;\n\telement.style.oTransform = style;\n}\n\nfunction animateSVG(svgContainer, elements) {\n\tlet newElements = [];\n\tlet animElements = [];\n\n\telements.map(element => {\n\t\tlet unit = element[0];\n\t\tlet parent = unit.parentNode;\n\n\t\tlet animElement, newElement;\n\n\t\telement[0] = unit;\n\t\t[animElement, newElement] = animateSVGElement(...element);\n\n\t\tnewElements.push(newElement);\n\t\tanimElements.push([animElement, parent]);\n\n\t\tparent.replaceChild(animElement, unit);\n\t});\n\n\tlet animSvg = svgContainer.cloneNode(true);\n\n\tanimElements.map((animElement, i) => {\n\t\tanimElement[1].replaceChild(newElements[i], animElement[0]);\n\t\telements[i][0] = newElements[i];\n\t});\n\n\treturn animSvg;\n}\n\nfunction runSMILAnimation(parent, svgElement, elementsToAnimate) {\n\tif(elementsToAnimate.length === 0) return;\n\n\tlet animSvgElement = animateSVG(svgElement, elementsToAnimate);\n\tif(svgElement.parentNode == parent) {\n\t\tparent.removeChild(svgElement);\n\t\tparent.appendChild(animSvgElement);\n\n\t}\n\n\t// Replace the new svgElement (data has already been replaced)\n\tsetTimeout(() => {\n\t\tif(animSvgElement.parentNode == parent) {\n\t\t\tparent.removeChild(animSvgElement);\n\t\t\tparent.appendChild(svgElement);\n\t\t}\n\t}, REPLACE_ALL_NEW_DUR);\n}\n\nconst CSSTEXT = \".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;border-top-color:rgba(0,0,0,.8)}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}\";\n\nfunction downloadFile(filename, data) {\n\tvar a = document.createElement('a');\n\ta.style = \"display: none\";\n\tvar blob = new Blob(data, {type: \"image/svg+xml; charset=utf-8\"});\n\tvar url = window.URL.createObjectURL(blob);\n\ta.href = url;\n\ta.download = filename;\n\tdocument.body.appendChild(a);\n\ta.click();\n\tsetTimeout(function(){\n\t\tdocument.body.removeChild(a);\n\t\twindow.URL.revokeObjectURL(url);\n\t}, 300);\n}\n\nfunction prepareForExport(svg) {\n\tlet clone = svg.cloneNode(true);\n\tclone.classList.add('chart-container');\n\tclone.setAttribute('xmlns', \"http://www.w3.org/2000/svg\");\n\tclone.setAttribute('xmlns:xlink', \"http://www.w3.org/1999/xlink\");\n\tlet styleEl = $.create('style', {\n\t\t'innerHTML': CSSTEXT\n\t});\n\tclone.insertBefore(styleEl, clone.firstChild);\n\n\tlet container = $.create('div');\n\tcontainer.appendChild(clone);\n\n\treturn container.innerHTML;\n}\n\nclass BaseChart {\n\tconstructor(parent, options) {\n\n\t\tthis.parent = typeof parent === 'string'\n\t\t\t? document.querySelector(parent)\n\t\t\t: parent;\n\n\t\tif (!(this.parent instanceof HTMLElement)) {\n\t\t\tthrow new Error('No `parent` element to render on was provided.');\n\t\t}\n\n\t\tthis.rawChartArgs = options;\n\n\t\tthis.title = options.title || '';\n\t\tthis.type = options.type || '';\n\n\t\tthis.realData = this.prepareData(options.data);\n\t\tthis.data = this.prepareFirstData(this.realData);\n\n\t\tthis.colors = this.validateColors(options.colors, this.type);\n\n\t\tthis.config = {\n\t\t\tshowTooltip: 1, // calculate\n\t\t\tshowLegend: 1, // calculate\n\t\t\tisNavigable: options.isNavigable || 0,\n\t\t\tanimate: (typeof options.animate !== 'undefined') ? options.animate : 1,\n\t\t\ttruncateLegends: options.truncateLegends || 1\n\t\t};\n\n\t\tthis.measures = JSON.parse(JSON.stringify(BASE_MEASURES));\n\t\tlet m = this.measures;\n\t\tthis.setMeasures(options);\n\t\tif(!this.title.length) { m.titleHeight = 0; }\n\t\tif(!this.config.showLegend) m.legendHeight = 0;\n\t\tthis.argHeight = options.height || m.baseHeight;\n\n\t\tthis.state = {};\n\t\tthis.options = {};\n\n\t\tthis.initTimeout = INIT_CHART_UPDATE_TIMEOUT;\n\n\t\tif(this.config.isNavigable) {\n\t\t\tthis.overlays = [];\n\t\t}\n\n\t\tthis.configure(options);\n\t}\n\n\tprepareData(data) {\n\t\treturn data;\n\t}\n\n\tprepareFirstData(data) {\n\t\treturn data;\n\t}\n\n\tvalidateColors(colors, type) {\n\t\tconst validColors = [];\n\t\tcolors = (colors || []).concat(DEFAULT_COLORS[type]);\n\t\tcolors.forEach((string) => {\n\t\t\tconst color = getColor(string);\n\t\t\tif(!isValidColor(color)) {\n\t\t\t\tconsole.warn('\"' + string + '\" is not a valid color.');\n\t\t\t} else {\n\t\t\t\tvalidColors.push(color);\n\t\t\t}\n\t\t});\n\t\treturn validColors;\n\t}\n\n\tsetMeasures() {\n\t\t// Override measures, including those for title and legend\n\t\t// set config for legend and title\n\t}\n\n\tconfigure() {\n\t\tlet height = this.argHeight;\n\t\tthis.baseHeight = height;\n\t\tthis.height = height - getExtraHeight(this.measures);\n\n\t\t// Bind window events\n\t\tthis.boundDrawFn = () => this.draw(true);\n\t\twindow.addEventListener('resize', this.boundDrawFn);\n\t\twindow.addEventListener('orientationchange', this.boundDrawFn);\n\t}\n\n\tdestroy() {\n\t\twindow.removeEventListener('resize', this.boundDrawFn);\n\t\twindow.removeEventListener('orientationchange', this.boundDrawFn);\n\t}\n\n\t// Has to be called manually\n\tsetup() {\n\t\tthis.makeContainer();\n\t\tthis.updateWidth();\n\t\tthis.makeTooltip();\n\n\t\tthis.draw(false, true);\n\t}\n\n\tmakeContainer() {\n\t\t// Chart needs a dedicated parent element\n\t\tthis.parent.innerHTML = '';\n\n\t\tlet args = {\n\t\t\tinside: this.parent,\n\t\t\tclassName: 'chart-container'\n\t\t};\n\n\t\tif(this.independentWidth) {\n\t\t\targs.styles = { width: this.independentWidth + 'px' };\n\t\t}\n\n\t\tthis.container = $.create('div', args);\n\t}\n\n\tmakeTooltip() {\n\t\tthis.tip = new SvgTip({\n\t\t\tparent: this.container,\n\t\t\tcolors: this.colors\n\t\t});\n\t\tthis.bindTooltip();\n\t}\n\n\tbindTooltip() {}\n\n\tdraw(onlyWidthChange=false, init=false) {\n\t\tif (onlyWidthChange && isHidden(this.parent)) {\n\t\t\t// Don't update anything if the chart is hidden\n\t\t\treturn;\n\t\t}\n\t\tthis.updateWidth();\n\n\t\tthis.calc(onlyWidthChange);\n\t\tthis.makeChartArea();\n\t\tthis.setupComponents();\n\n\t\tthis.components.forEach(c => c.setup(this.drawArea));\n\t\t// this.components.forEach(c => c.make());\n\t\tthis.render(this.components, false);\n\n\t\tif(init) {\n\t\t\tthis.data = this.realData;\n\t\t\tsetTimeout(() => {this.update(this.data);}, this.initTimeout);\n\t\t}\n\n\t\tthis.renderLegend();\n\n\t\tthis.setupNavigation(init);\n\t}\n\n\tcalc() {} // builds state\n\n\tupdateWidth() {\n\t\tthis.baseWidth = getElementContentWidth(this.parent);\n\t\tthis.width = this.baseWidth - getExtraWidth(this.measures);\n\t}\n\n\tmakeChartArea() {\n\t\tif(this.svg) {\n\t\t\tthis.container.removeChild(this.svg);\n\t\t}\n\t\tlet m = this.measures;\n\n\t\tthis.svg = makeSVGContainer(\n\t\t\tthis.container,\n\t\t\t'frappe-chart chart',\n\t\t\tthis.baseWidth,\n\t\t\tthis.baseHeight\n\t\t);\n\t\tthis.svgDefs = makeSVGDefs(this.svg);\n\n\t\tif(this.title.length) {\n\t\t\tthis.titleEL = makeText(\n\t\t\t\t'title',\n\t\t\t\tm.margins.left,\n\t\t\t\tm.margins.top,\n\t\t\t\tthis.title,\n\t\t\t\t{\n\t\t\t\t\tfontSize: m.titleFontSize,\n\t\t\t\t\tfill: '#666666',\n\t\t\t\t\tdy: m.titleFontSize\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tlet top = getTopOffset(m);\n\t\tthis.drawArea = makeSVGGroup(\n\t\t\tthis.type + '-chart chart-draw-area',\n\t\t\t`translate(${getLeftOffset(m)}, ${top})`\n\t\t);\n\n\t\tif(this.config.showLegend) {\n\t\t\ttop += this.height + m.paddings.bottom;\n\t\t\tthis.legendArea = makeSVGGroup(\n\t\t\t\t'chart-legend',\n\t\t\t\t`translate(${getLeftOffset(m)}, ${top})`\n\t\t\t);\n\t\t}\n\n\t\tif(this.title.length) { this.svg.appendChild(this.titleEL); }\n\t\tthis.svg.appendChild(this.drawArea);\n\t\tif(this.config.showLegend) { this.svg.appendChild(this.legendArea); }\n\n\t\tthis.updateTipOffset(getLeftOffset(m), getTopOffset(m));\n\t}\n\n\tupdateTipOffset(x, y) {\n\t\tthis.tip.offset = {\n\t\t\tx: x,\n\t\t\ty: y\n\t\t};\n\t}\n\n\tsetupComponents() { this.components = new Map(); }\n\n\tupdate(data) {\n\t\tif(!data) {\n\t\t\tconsole.error('No data to update.');\n\t\t}\n\t\tthis.data = this.prepareData(data);\n\t\tthis.calc(); // builds state\n\t\tthis.render(this.components, this.config.animate);\n\t}\n\n\trender(components=this.components, animate=true) {\n\t\tif(this.config.isNavigable) {\n\t\t\t// Remove all existing overlays\n\t\t\tthis.overlays.map(o => o.parentNode.removeChild(o));\n\t\t\t// ref.parentNode.insertBefore(element, ref);\n\t\t}\n\t\tlet elementsToAnimate = [];\n\t\t// Can decouple to this.refreshComponents() first to save animation timeout\n\t\tcomponents.forEach(c => {\n\t\t\telementsToAnimate = elementsToAnimate.concat(c.update(animate));\n\t\t});\n\t\tif(elementsToAnimate.length > 0) {\n\t\t\trunSMILAnimation(this.container, this.svg, elementsToAnimate);\n\t\t\tsetTimeout(() => {\n\t\t\t\tcomponents.forEach(c => c.make());\n\t\t\t\tthis.updateNav();\n\t\t\t}, CHART_POST_ANIMATE_TIMEOUT);\n\t\t} else {\n\t\t\tcomponents.forEach(c => c.make());\n\t\t\tthis.updateNav();\n\t\t}\n\t}\n\n\tupdateNav() {\n\t\tif(this.config.isNavigable) {\n\t\t\tthis.makeOverlay();\n\t\t\tthis.bindUnits();\n\t\t}\n\t}\n\n\trenderLegend() {}\n\n\tsetupNavigation(init=false) {\n\t\tif(!this.config.isNavigable) return;\n\n\t\tif(init) {\n\t\t\tthis.bindOverlay();\n\n\t\t\tthis.keyActions = {\n\t\t\t\t'13': this.onEnterKey.bind(this),\n\t\t\t\t'37': this.onLeftArrow.bind(this),\n\t\t\t\t'38': this.onUpArrow.bind(this),\n\t\t\t\t'39': this.onRightArrow.bind(this),\n\t\t\t\t'40': this.onDownArrow.bind(this),\n\t\t\t};\n\n\t\t\tdocument.addEventListener('keydown', (e) => {\n\t\t\t\tif(isElementInViewport(this.container)) {\n\t\t\t\t\te = e || window.event;\n\t\t\t\t\tif(this.keyActions[e.keyCode]) {\n\t\t\t\t\t\tthis.keyActions[e.keyCode]();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tmakeOverlay() {}\n\tupdateOverlay() {}\n\tbindOverlay() {}\n\tbindUnits() {}\n\n\tonLeftArrow() {}\n\tonRightArrow() {}\n\tonUpArrow() {}\n\tonDownArrow() {}\n\tonEnterKey() {}\n\n\taddDataPoint() {}\n\tremoveDataPoint() {}\n\n\tgetDataPoint() {}\n\tsetCurrentDataPoint() {}\n\n\tupdateDataset() {}\n\n\texport() {\n\t\tlet chartSvg = prepareForExport(this.svg);\n\t\tdownloadFile(this.title || 'Chart', [chartSvg]);\n\t}\n}\n\nclass AggregationChart extends BaseChart {\n\tconstructor(parent, args) {\n\t\tsuper(parent, args);\n\t}\n\n\tconfigure(args) {\n\t\tsuper.configure(args);\n\n\t\tthis.config.maxSlices = args.maxSlices || 20;\n\t\tthis.config.maxLegendPoints = args.maxLegendPoints || 20;\n\t}\n\n\tcalc() {\n\t\tlet s = this.state;\n\t\tlet maxSlices = this.config.maxSlices;\n\t\ts.sliceTotals = [];\n\n\t\tlet allTotals = this.data.labels.map((label, i) => {\n\t\t\tlet total = 0;\n\t\t\tthis.data.datasets.map(e => {\n\t\t\t\ttotal += e.values[i];\n\t\t\t});\n\t\t\treturn [total, label];\n\t\t}).filter(d => { return d[0] >= 0; }); // keep only positive results\n\n\t\tlet totals = allTotals;\n\t\tif(allTotals.length > maxSlices) {\n\t\t\t// Prune and keep a grey area for rest as per maxSlices\n\t\t\tallTotals.sort((a, b) => { return b[0] - a[0]; });\n\n\t\t\ttotals = allTotals.slice(0, maxSlices-1);\n\t\t\tlet remaining = allTotals.slice(maxSlices-1);\n\n\t\t\tlet sumOfRemaining = 0;\n\t\t\tremaining.map(d => {sumOfRemaining += d[0];});\n\t\t\ttotals.push([sumOfRemaining, 'Rest']);\n\t\t\tthis.colors[maxSlices-1] = 'grey';\n\t\t}\n\n\t\ts.labels = [];\n\t\ttotals.map(d => {\n\t\t\ts.sliceTotals.push(d[0]);\n\t\t\ts.labels.push(d[1]);\n\t\t});\n\n\t\ts.grandTotal = s.sliceTotals.reduce((a, b) => a + b, 0);\n\n\t\tthis.center = {\n\t\t\tx: this.width / 2,\n\t\t\ty: this.height / 2\n\t\t};\n\t}\n\n\trenderLegend() {\n\t\tlet s = this.state;\n\t\tthis.legendArea.textContent = '';\n\t\tthis.legendTotals = s.sliceTotals.slice(0, this.config.maxLegendPoints);\n\n\t\tlet count = 0;\n\t\tlet y = 0;\n\t\tthis.legendTotals.map((d, i) => {\n\t\t\tlet barWidth = 150;\n\t\t\tlet divisor = Math.floor(\n\t\t\t\t(this.width - getExtraWidth(this.measures))/barWidth\n\t\t\t);\n\t\t\tif (this.legendTotals.length < divisor) {\n\t\t\t\tbarWidth = this.width/this.legendTotals.length;\n\t\t\t}\n\t\t\tif(count > divisor) {\n\t\t\t\tcount = 0;\n\t\t\t\ty += 20;\n\t\t\t}\n\t\t\tlet x = barWidth * count + 5;\n\t\t\tlet label = this.config.truncateLegends ? truncateString(s.labels[i], barWidth/10) : s.labels[i];\n\t\t\tlet dot = legendDot(\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\t5,\n\t\t\t\tthis.colors[i],\n\t\t\t\t`${label}: ${d}`,\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tthis.legendArea.appendChild(dot);\n\t\t\tcount++;\n\t\t});\n\t}\n}\n\n// Playing around with dates\n\nconst NO_OF_YEAR_MONTHS = 12;\nconst NO_OF_DAYS_IN_WEEK = 7;\n\nconst NO_OF_MILLIS = 1000;\nconst SEC_IN_DAY = 86400;\n\nconst MONTH_NAMES = [\"January\", \"February\", \"March\", \"April\", \"May\",\n\t\"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\n\nconst DAY_NAMES_SHORT = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\n\n// https://stackoverflow.com/a/11252167/6495043\nfunction treatAsUtc(date) {\n\tlet result = new Date(date);\n\tresult.setMinutes(result.getMinutes() - result.getTimezoneOffset());\n\treturn result;\n}\n\nfunction getYyyyMmDd(date) {\n\tlet dd = date.getDate();\n\tlet mm = date.getMonth() + 1; // getMonth() is zero-based\n\treturn [\n\t\tdate.getFullYear(),\n\t\t(mm>9 ? '' : '0') + mm,\n\t\t(dd>9 ? '' : '0') + dd\n\t].join('-');\n}\n\nfunction clone(date) {\n\treturn new Date(date.getTime());\n}\n\n\n\n\n\n// export function getMonthsBetween(startDate, endDate) {}\n\nfunction getWeeksBetween(startDate, endDate) {\n\tlet weekStartDate = setDayToSunday(startDate);\n\treturn Math.ceil(getDaysBetween(weekStartDate, endDate) / NO_OF_DAYS_IN_WEEK);\n}\n\nfunction getDaysBetween(startDate, endDate) {\n\tlet millisecondsPerDay = SEC_IN_DAY * NO_OF_MILLIS;\n\treturn (treatAsUtc(endDate) - treatAsUtc(startDate)) / millisecondsPerDay;\n}\n\nfunction areInSameMonth(startDate, endDate) {\n\treturn startDate.getMonth() === endDate.getMonth()\n\t\t&& startDate.getFullYear() === endDate.getFullYear();\n}\n\nfunction getMonthName(i, short=false) {\n\tlet monthName = MONTH_NAMES[i];\n\treturn short ? monthName.slice(0, 3) : monthName;\n}\n\nfunction getLastDateInMonth (month, year) {\n\treturn new Date(year, month + 1, 0); // 0: last day in previous month\n}\n\n// mutates\nfunction setDayToSunday(date) {\n\tlet newDate = clone(date);\n\tconst day = newDate.getDay();\n\tif(day !== 0) {\n\t\taddDays(newDate, (-1) * day);\n\t}\n\treturn newDate;\n}\n\n// mutates\nfunction addDays(date, numberOfDays) {\n\tdate.setDate(date.getDate() + numberOfDays);\n}\n\nclass ChartComponent {\n\tconstructor({\n\t\tlayerClass = '',\n\t\tlayerTransform = '',\n\t\tconstants,\n\n\t\tgetData,\n\t\tmakeElements,\n\t\tanimateElements\n\t}) {\n\t\tthis.layerTransform = layerTransform;\n\t\tthis.constants = constants;\n\n\t\tthis.makeElements = makeElements;\n\t\tthis.getData = getData;\n\n\t\tthis.animateElements = animateElements;\n\n\t\tthis.store = [];\n\t\tthis.labels = [];\n\n\t\tthis.layerClass = layerClass;\n\t\tthis.layerClass = typeof(this.layerClass) === 'function'\n\t\t\t? this.layerClass() : this.layerClass;\n\n\t\tthis.refresh();\n\t}\n\n\trefresh(data) {\n\t\tthis.data = data || this.getData();\n\t}\n\n\tsetup(parent) {\n\t\tthis.layer = makeSVGGroup(this.layerClass, this.layerTransform, parent);\n\t}\n\n\tmake() {\n\t\tthis.render(this.data);\n\t\tthis.oldData = this.data;\n\t}\n\n\trender(data) {\n\t\tthis.store = this.makeElements(data);\n\n\t\tthis.layer.textContent = '';\n\t\tthis.store.forEach(element => {\n\t\t\tthis.layer.appendChild(element);\n\t\t});\n\t\tthis.labels.forEach(element => {\n\t\t\tthis.layer.appendChild(element);\n\t\t});\n\t}\n\n\tupdate(animate = true) {\n\t\tthis.refresh();\n\t\tlet animateElements = [];\n\t\tif(animate) {\n\t\t\tanimateElements = this.animateElements(this.data) || [];\n\t\t}\n\t\treturn animateElements;\n\t}\n}\n\nlet componentConfigs = {\n\tdonutSlices: {\n\t\tlayerClass: 'donut-slices',\n\t\tmakeElements(data) {\n\t\t\treturn data.sliceStrings.map((s, i) => {\n\t\t\t\tlet slice = makePath(s, 'donut-path', data.colors[i], 'none', data.strokeWidth);\n\t\t\t\tslice.style.transition = 'transform .3s;';\n\t\t\t\treturn slice;\n\t\t\t});\n\t\t},\n\n\t\tanimateElements(newData) {\n\t\t\treturn this.store.map((slice, i) => animatePathStr(slice, newData.sliceStrings[i]));\n\t\t},\n\t},\n\tpieSlices: {\n\t\tlayerClass: 'pie-slices',\n\t\tmakeElements(data) {\n\t\t\treturn data.sliceStrings.map((s, i) =>{\n\t\t\t\tlet slice = makePath(s, 'pie-path', 'none', data.colors[i]);\n\t\t\t\tslice.style.transition = 'transform .3s;';\n\t\t\t\treturn slice;\n\t\t\t});\n\t\t},\n\n\t\tanimateElements(newData) {\n\t\t\treturn this.store.map((slice, i) =>\n\t\t\t\tanimatePathStr(slice, newData.sliceStrings[i])\n\t\t\t);\n\t\t}\n\t},\n\tpercentageBars: {\n\t\tlayerClass: 'percentage-bars',\n\t\tmakeElements(data) {\n\t\t\treturn data.xPositions.map((x, i) =>{\n\t\t\t\tlet y = 0;\n\t\t\t\tlet bar = percentageBar(x, y, data.widths[i],\n\t\t\t\t\tthis.constants.barHeight, this.constants.barDepth, data.colors[i]);\n\t\t\t\treturn bar;\n\t\t\t});\n\t\t},\n\n\t\tanimateElements(newData) {\n\t\t\tif(newData) return [];\n\t\t}\n\t},\n\tyAxis: {\n\t\tlayerClass: 'y axis',\n\t\tmakeElements(data) {\n\t\t\treturn data.positions.map((position, i) =>\n\t\t\t\tyLine(position, data.labels[i], this.constants.width,\n\t\t\t\t\t{mode: this.constants.mode, pos: this.constants.pos, shortenNumbers: this.constants.shortenNumbers})\n\t\t\t);\n\t\t},\n\n\t\tanimateElements(newData) {\n\t\t\tlet newPos = newData.positions;\n\t\t\tlet newLabels = newData.labels;\n\t\t\tlet oldPos = this.oldData.positions;\n\t\t\tlet oldLabels = this.oldData.labels;\n\n\t\t\t[oldPos, newPos] = equilizeNoOfElements(oldPos, newPos);\n\t\t\t[oldLabels, newLabels] = equilizeNoOfElements(oldLabels, newLabels);\n\n\t\t\tthis.render({\n\t\t\t\tpositions: oldPos,\n\t\t\t\tlabels: newLabels\n\t\t\t});\n\n\t\t\treturn this.store.map((line, i) => {\n\t\t\t\treturn translateHoriLine(\n\t\t\t\t\tline, newPos[i], oldPos[i]\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t},\n\n\txAxis: {\n\t\tlayerClass: 'x axis',\n\t\tmakeElements(data) {\n\t\t\treturn data.positions.map((position, i) =>\n\t\t\t\txLine(position, data.calcLabels[i], this.constants.height,\n\t\t\t\t\t{mode: this.constants.mode, pos: this.constants.pos})\n\t\t\t);\n\t\t},\n\n\t\tanimateElements(newData) {\n\t\t\tlet newPos = newData.positions;\n\t\t\tlet newLabels = newData.calcLabels;\n\t\t\tlet oldPos = this.oldData.positions;\n\t\t\tlet oldLabels = this.oldData.calcLabels;\n\n\t\t\t[oldPos, newPos] = equilizeNoOfElements(oldPos, newPos);\n\t\t\t[oldLabels, newLabels] = equilizeNoOfElements(oldLabels, newLabels);\n\n\t\t\tthis.render({\n\t\t\t\tpositions: oldPos,\n\t\t\t\tcalcLabels: newLabels\n\t\t\t});\n\n\t\t\treturn this.store.map((line, i) => {\n\t\t\t\treturn translateVertLine(\n\t\t\t\t\tline, newPos[i], oldPos[i]\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t},\n\n\tyMarkers: {\n\t\tlayerClass: 'y-markers',\n\t\tmakeElements(data) {\n\t\t\treturn data.map(m =>\n\t\t\t\tyMarker(m.position, m.label, this.constants.width,\n\t\t\t\t\t{labelPos: m.options.labelPos, mode: 'span', lineType: 'dashed'})\n\t\t\t);\n\t\t},\n\t\tanimateElements(newData) {\n\t\t\t[this.oldData, newData] = equilizeNoOfElements(this.oldData, newData);\n\n\t\t\tlet newPos = newData.map(d => d.position);\n\t\t\tlet newLabels = newData.map(d => d.label);\n\t\t\tlet newOptions = newData.map(d => d.options);\n\n\t\t\tlet oldPos = this.oldData.map(d => d.position);\n\n\t\t\tthis.render(oldPos.map((pos, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tposition: oldPos[i],\n\t\t\t\t\tlabel: newLabels[i],\n\t\t\t\t\toptions: newOptions[i]\n\t\t\t\t};\n\t\t\t}));\n\n\t\t\treturn this.store.map((line, i) => {\n\t\t\t\treturn translateHoriLine(\n\t\t\t\t\tline, newPos[i], oldPos[i]\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t},\n\n\tyRegions: {\n\t\tlayerClass: 'y-regions',\n\t\tmakeElements(data) {\n\t\t\treturn data.map(r =>\n\t\t\t\tyRegion(r.startPos, r.endPos, this.constants.width,\n\t\t\t\t\tr.label, {labelPos: r.options.labelPos})\n\t\t\t);\n\t\t},\n\t\tanimateElements(newData) {\n\t\t\t[this.oldData, newData] = equilizeNoOfElements(this.oldData, newData);\n\n\t\t\tlet newPos = newData.map(d => d.endPos);\n\t\t\tlet newLabels = newData.map(d => d.label);\n\t\t\tlet newStarts = newData.map(d => d.startPos);\n\t\t\tlet newOptions = newData.map(d => d.options);\n\n\t\t\tlet oldPos = this.oldData.map(d => d.endPos);\n\t\t\tlet oldStarts = this.oldData.map(d => d.startPos);\n\n\t\t\tthis.render(oldPos.map((pos, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tstartPos: oldStarts[i],\n\t\t\t\t\tendPos: oldPos[i],\n\t\t\t\t\tlabel: newLabels[i],\n\t\t\t\t\toptions: newOptions[i]\n\t\t\t\t};\n\t\t\t}));\n\n\t\t\tlet animateElements = [];\n\n\t\t\tthis.store.map((rectGroup, i) => {\n\t\t\t\tanimateElements = animateElements.concat(animateRegion(\n\t\t\t\t\trectGroup, newStarts[i], newPos[i], oldPos[i]\n\t\t\t\t));\n\t\t\t});\n\n\t\t\treturn animateElements;\n\t\t}\n\t},\n\n\theatDomain: {\n\t\tlayerClass: function() { return 'heat-domain domain-' + this.constants.index; },\n\t\tmakeElements(data) {\n\t\t\tlet {index, colWidth, rowHeight, squareSize, radius, xTranslate} = this.constants;\n\t\t\tlet monthNameHeight = -12;\n\t\t\tlet x = xTranslate, y = 0;\n\n\t\t\tthis.serializedSubDomains = [];\n\n\t\t\tdata.cols.map((week, weekNo) => {\n\t\t\t\tif(weekNo === 1) {\n\t\t\t\t\tthis.labels.push(\n\t\t\t\t\t\tmakeText('domain-name', x, monthNameHeight, getMonthName(index, true).toUpperCase(),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfontSize: 9\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tweek.map((day, i) => {\n\t\t\t\t\tif(day.fill) {\n\t\t\t\t\t\tlet data = {\n\t\t\t\t\t\t\t'data-date': day.yyyyMmDd,\n\t\t\t\t\t\t\t'data-value': day.dataValue,\n\t\t\t\t\t\t\t'data-day': i\n\t\t\t\t\t\t};\n\t\t\t\t\t\tlet square = heatSquare('day', x, y, squareSize, radius, day.fill, data);\n\t\t\t\t\t\tthis.serializedSubDomains.push(square);\n\t\t\t\t\t}\n\t\t\t\t\ty += rowHeight;\n\t\t\t\t});\n\t\t\t\ty = 0;\n\t\t\t\tx += colWidth;\n\t\t\t});\n\n\t\t\treturn this.serializedSubDomains;\n\t\t},\n\n\t\tanimateElements(newData) {\n\t\t\tif(newData) return [];\n\t\t}\n\t},\n\n\tbarGraph: {\n\t\tlayerClass: function() { return 'dataset-units dataset-bars dataset-' + this.constants.index; },\n\t\tmakeElements(data) {\n\t\t\tlet c = this.constants;\n\t\t\tthis.unitType = 'bar';\n\t\t\tthis.units = data.yPositions.map((y, j) => {\n\t\t\t\treturn datasetBar(\n\t\t\t\t\tdata.xPositions[j],\n\t\t\t\t\ty,\n\t\t\t\t\tdata.barWidth,\n\t\t\t\t\tc.color,\n\t\t\t\t\tdata.labels[j],\n\t\t\t\t\tj,\n\t\t\t\t\tdata.offsets[j],\n\t\t\t\t\t{\n\t\t\t\t\t\tzeroLine: data.zeroLine,\n\t\t\t\t\t\tbarsWidth: data.barsWidth,\n\t\t\t\t\t\tminHeight: c.minHeight\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t\treturn this.units;\n\t\t},\n\t\tanimateElements(newData) {\n\t\t\tlet newXPos = newData.xPositions;\n\t\t\tlet newYPos = newData.yPositions;\n\t\t\tlet newOffsets = newData.offsets;\n\t\t\tlet newLabels = newData.labels;\n\n\t\t\tlet oldXPos = this.oldData.xPositions;\n\t\t\tlet oldYPos = this.oldData.yPositions;\n\t\t\tlet oldOffsets = this.oldData.offsets;\n\t\t\tlet oldLabels = this.oldData.labels;\n\n\t\t\t[oldXPos, newXPos] = equilizeNoOfElements(oldXPos, newXPos);\n\t\t\t[oldYPos, newYPos] = equilizeNoOfElements(oldYPos, newYPos);\n\t\t\t[oldOffsets, newOffsets] = equilizeNoOfElements(oldOffsets, newOffsets);\n\t\t\t[oldLabels, newLabels] = equilizeNoOfElements(oldLabels, newLabels);\n\n\t\t\tthis.render({\n\t\t\t\txPositions: oldXPos,\n\t\t\t\tyPositions: oldYPos,\n\t\t\t\toffsets: oldOffsets,\n\t\t\t\tlabels: newLabels,\n\n\t\t\t\tzeroLine: this.oldData.zeroLine,\n\t\t\t\tbarsWidth: this.oldData.barsWidth,\n\t\t\t\tbarWidth: this.oldData.barWidth,\n\t\t\t});\n\n\t\t\tlet animateElements = [];\n\n\t\t\tthis.store.map((bar, i) => {\n\t\t\t\tanimateElements = animateElements.concat(animateBar(\n\t\t\t\t\tbar, newXPos[i], newYPos[i], newData.barWidth, newOffsets[i],\n\t\t\t\t\t{zeroLine: newData.zeroLine}\n\t\t\t\t));\n\t\t\t});\n\n\t\t\treturn animateElements;\n\t\t}\n\t},\n\n\tlineGraph: {\n\t\tlayerClass: function() { return 'dataset-units dataset-line dataset-' + this.constants.index; },\n\t\tmakeElements(data) {\n\t\t\tlet c = this.constants;\n\t\t\tthis.unitType = 'dot';\n\t\t\tthis.paths = {};\n\t\t\tif(!c.hideLine) {\n\t\t\t\tthis.paths = getPaths(\n\t\t\t\t\tdata.xPositions,\n\t\t\t\t\tdata.yPositions,\n\t\t\t\t\tc.color,\n\t\t\t\t\t{\n\t\t\t\t\t\theatline: c.heatline,\n\t\t\t\t\t\tregionFill: c.regionFill,\n\t\t\t\t\t\tspline: c.spline\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tsvgDefs: c.svgDefs,\n\t\t\t\t\t\tzeroLine: data.zeroLine\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.units = [];\n\t\t\tif(!c.hideDots) {\n\t\t\t\tthis.units = data.yPositions.map((y, j) => {\n\t\t\t\t\treturn datasetDot(\n\t\t\t\t\t\tdata.xPositions[j],\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\tc.color,\n\t\t\t\t\t\t(c.valuesOverPoints ? data.values[j] : ''),\n\t\t\t\t\t\tj\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn Object.values(this.paths).concat(this.units);\n\t\t},\n\t\tanimateElements(newData) {\n\t\t\tlet newXPos = newData.xPositions;\n\t\t\tlet newYPos = newData.yPositions;\n\t\t\tlet newValues = newData.values;\n\n\t\t\tlet oldXPos = this.oldData.xPositions;\n\t\t\tlet oldYPos = this.oldData.yPositions;\n\t\t\tlet oldValues = this.oldData.values;\n\n\t\t\t[oldXPos, newXPos] = equilizeNoOfElements(oldXPos, newXPos);\n\t\t\t[oldYPos, newYPos] = equilizeNoOfElements(oldYPos, newYPos);\n\t\t\t[oldValues, newValues] = equilizeNoOfElements(oldValues, newValues);\n\n\t\t\tthis.render({\n\t\t\t\txPositions: oldXPos,\n\t\t\t\tyPositions: oldYPos,\n\t\t\t\tvalues: newValues,\n\n\t\t\t\tzeroLine: this.oldData.zeroLine,\n\t\t\t\tradius: this.oldData.radius,\n\t\t\t});\n\n\t\t\tlet animateElements = [];\n\n\t\t\tif(Object.keys(this.paths).length) {\n\t\t\t\tanimateElements = animateElements.concat(animatePath(\n\t\t\t\t\tthis.paths, newXPos, newYPos, newData.zeroLine, this.constants.spline));\n\t\t\t}\n\n\t\t\tif(this.units.length) {\n\t\t\t\tthis.units.map((dot, i) => {\n\t\t\t\t\tanimateElements = animateElements.concat(animateDot(\n\t\t\t\t\t\tdot, newXPos[i], newYPos[i]));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn animateElements;\n\t\t}\n\t}\n};\n\nfunction getComponent(name, constants, getData) {\n\tlet keys = Object.keys(componentConfigs).filter(k => name.includes(k));\n\tlet config = componentConfigs[keys[0]];\n\tObject.assign(config, {\n\t\tconstants: constants,\n\t\tgetData: getData\n\t});\n\treturn new ChartComponent(config);\n}\n\nclass PercentageChart extends AggregationChart {\n\tconstructor(parent, args) {\n\t\tsuper(parent, args);\n\t\tthis.type = 'percentage';\n\t\tthis.setup();\n\t}\n\n\tsetMeasures(options) {\n\t\tlet m = this.measures;\n\t\tthis.barOptions = options.barOptions || {};\n\n\t\tlet b = this.barOptions;\n\t\tb.height = b.height || PERCENTAGE_BAR_DEFAULT_HEIGHT;\n\t\tb.depth = b.depth || PERCENTAGE_BAR_DEFAULT_DEPTH;\n\n\t\tm.paddings.right = 30;\n\t\tm.legendHeight = 60;\n\t\tm.baseHeight = (b.height + b.depth * 0.5) * 8;\n\t}\n\n\tsetupComponents() {\n\t\tlet s = this.state;\n\n\t\tlet componentConfigs = [\n\t\t\t[\n\t\t\t\t'percentageBars',\n\t\t\t\t{\n\t\t\t\t\tbarHeight: this.barOptions.height,\n\t\t\t\t\tbarDepth: this.barOptions.depth,\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\txPositions: s.xPositions,\n\t\t\t\t\t\twidths: s.widths,\n\t\t\t\t\t\tcolors: this.colors\n\t\t\t\t\t};\n\t\t\t\t}.bind(this)\n\t\t\t]\n\t\t];\n\n\t\tthis.components = new Map(componentConfigs\n\t\t\t.map(args => {\n\t\t\t\tlet component = getComponent(...args);\n\t\t\t\treturn [args[0], component];\n\t\t\t}));\n\t}\n\n\tcalc() {\n\t\tsuper.calc();\n\t\tlet s = this.state;\n\n\t\ts.xPositions = [];\n\t\ts.widths = [];\n\n\t\tlet xPos = 0;\n\t\ts.sliceTotals.map((value) => {\n\t\t\tlet width = this.width * value / s.grandTotal;\n\t\t\ts.widths.push(width);\n\t\t\ts.xPositions.push(xPos);\n\t\t\txPos += width;\n\t\t});\n\t}\n\n\tmakeDataByIndex() { }\n\n\tbindTooltip() {\n\t\tlet s = this.state;\n\t\tthis.container.addEventListener('mousemove', (e) => {\n\t\t\tlet bars = this.components.get('percentageBars').store;\n\t\t\tlet bar = e.target;\n\t\t\tif(bars.includes(bar)) {\n\n\t\t\t\tlet i = bars.indexOf(bar);\n\t\t\t\tlet gOff = getOffset(this.container), pOff = getOffset(bar);\n\n\t\t\t\tlet x = pOff.left - gOff.left + parseInt(bar.getAttribute('width'))/2;\n\t\t\t\tlet y = pOff.top - gOff.top;\n\t\t\t\tlet title = (this.formattedLabels && this.formattedLabels.length>0\n\t\t\t\t\t? this.formattedLabels[i] : this.state.labels[i]) + ': ';\n\t\t\t\tlet fraction = s.sliceTotals[i]/s.grandTotal;\n\n\t\t\t\tthis.tip.setValues(x, y, {name: title, value: (fraction*100).toFixed(1) + \"%\"});\n\t\t\t\tthis.tip.showTip();\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass PieChart extends AggregationChart {\n\tconstructor(parent, args) {\n\t\tsuper(parent, args);\n\t\tthis.type = 'pie';\n\t\tthis.initTimeout = 0;\n\t\tthis.init = 1;\n\n\t\tthis.setup();\n\t}\n\n\tconfigure(args) {\n\t\tsuper.configure(args);\n\t\tthis.mouseMove = this.mouseMove.bind(this);\n\t\tthis.mouseLeave = this.mouseLeave.bind(this);\n\n\t\tthis.hoverRadio = args.hoverRadio || 0.1;\n\t\tthis.config.startAngle = args.startAngle || 0;\n\n\t\tthis.clockWise = args.clockWise || false;\n\t}\n\n\tcalc() {\n\t\tsuper.calc();\n\t\tlet s = this.state;\n\t\tthis.radius = (this.height > this.width ? this.center.x : this.center.y);\n\n\t\tconst { radius, clockWise } = this;\n\n\t\tconst prevSlicesProperties = s.slicesProperties || [];\n\t\ts.sliceStrings = [];\n\t\ts.slicesProperties = [];\n\t\tlet curAngle = 180 - this.config.startAngle;\n\t\ts.sliceTotals.map((total, i) => {\n\t\t\tconst startAngle = curAngle;\n\t\t\tconst originDiffAngle = (total / s.grandTotal) * FULL_ANGLE;\n\t\t\tconst largeArc = originDiffAngle > 180 ? 1: 0;\n\t\t\tconst diffAngle = clockWise ? -originDiffAngle : originDiffAngle;\n\t\t\tconst endAngle = curAngle = curAngle + diffAngle;\n\t\t\tconst startPosition = getPositionByAngle(startAngle, radius);\n\t\t\tconst endPosition = getPositionByAngle(endAngle, radius);\n\n\t\t\tconst prevProperty = this.init && prevSlicesProperties[i];\n\n\t\t\tlet curStart,curEnd;\n\t\t\tif(this.init) {\n\t\t\t\tcurStart = prevProperty ? prevProperty.startPosition : startPosition;\n\t\t\t\tcurEnd = prevProperty ? prevProperty.endPosition : startPosition;\n\t\t\t} else {\n\t\t\t\tcurStart = startPosition;\n\t\t\t\tcurEnd = endPosition;\n\t\t\t}\n\t\t\tconst curPath =\n\t\t\t\toriginDiffAngle === 360\n\t\t\t\t\t? makeCircleStr(curStart, curEnd, this.center, this.radius, clockWise, largeArc)\n\t\t\t\t\t: makeArcPathStr(curStart, curEnd, this.center, this.radius, clockWise, largeArc);\n\n\t\t\ts.sliceStrings.push(curPath);\n\t\t\ts.slicesProperties.push({\n\t\t\t\tstartPosition,\n\t\t\t\tendPosition,\n\t\t\t\tvalue: total,\n\t\t\t\ttotal: s.grandTotal,\n\t\t\t\tstartAngle,\n\t\t\t\tendAngle,\n\t\t\t\tangle: diffAngle\n\t\t\t});\n\n\t\t});\n\t\tthis.init = 0;\n\t}\n\n\tsetupComponents() {\n\t\tlet s = this.state;\n\n\t\tlet componentConfigs = [\n\t\t\t[\n\t\t\t\t'pieSlices',\n\t\t\t\t{ },\n\t\t\t\tfunction() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsliceStrings: s.sliceStrings,\n\t\t\t\t\t\tcolors: this.colors\n\t\t\t\t\t};\n\t\t\t\t}.bind(this)\n\t\t\t]\n\t\t];\n\n\t\tthis.components = new Map(componentConfigs\n\t\t\t.map(args => {\n\t\t\t\tlet component = getComponent(...args);\n\t\t\t\treturn [args[0], component];\n\t\t\t}));\n\t}\n\n\tcalTranslateByAngle(property){\n\t\tconst{radius,hoverRadio} = this;\n\t\tconst position = getPositionByAngle(property.startAngle+(property.angle / 2),radius);\n\t\treturn `translate3d(${(position.x) * hoverRadio}px,${(position.y) * hoverRadio}px,0)`;\n\t}\n\n\thoverSlice(path,i,flag,e){\n\t\tif(!path) return;\n\t\tconst color = this.colors[i];\n\t\tif(flag) {\n\t\t\ttransform(path, this.calTranslateByAngle(this.state.slicesProperties[i]));\n\t\t\tpath.style.fill = lightenDarkenColor(color, 50);\n\t\t\tlet g_off = getOffset(this.svg);\n\t\t\tlet x = e.pageX - g_off.left + 10;\n\t\t\tlet y = e.pageY - g_off.top - 10;\n\t\t\tlet title = (this.formatted_labels && this.formatted_labels.length > 0\n\t\t\t\t? this.formatted_labels[i] : this.state.labels[i]) + ': ';\n\t\t\tlet percent = (this.state.sliceTotals[i] * 100 / this.state.grandTotal).toFixed(1);\n\t\t\tthis.tip.setValues(x, y, {name: title, value: percent + \"%\"});\n\t\t\tthis.tip.showTip();\n\t\t} else {\n\t\t\ttransform(path,'translate3d(0,0,0)');\n\t\t\tthis.tip.hideTip();\n\t\t\tpath.style.fill = color;\n\t\t}\n\t}\n\n\tbindTooltip() {\n\t\tthis.container.addEventListener('mousemove', this.mouseMove);\n\t\tthis.container.addEventListener('mouseleave', this.mouseLeave);\n\t}\n\n\tmouseMove(e){\n\t\tconst target = e.target;\n\t\tlet slices = this.components.get('pieSlices').store;\n\t\tlet prevIndex = this.curActiveSliceIndex;\n\t\tlet prevAcitve = this.curActiveSlice;\n\t\tif(slices.includes(target)) {\n\t\t\tlet i = slices.indexOf(target);\n\t\t\tthis.hoverSlice(prevAcitve, prevIndex,false);\n\t\t\tthis.curActiveSlice = target;\n\t\t\tthis.curActiveSliceIndex = i;\n\t\t\tthis.hoverSlice(target, i, true, e);\n\t\t} else {\n\t\t\tthis.mouseLeave();\n\t\t}\n\t}\n\n\tmouseLeave(){\n\t\tthis.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,false);\n\t}\n}\n\nfunction normalize(x) {\n\t// Calculates mantissa and exponent of a number\n\t// Returns normalized number and exponent\n\t// https://stackoverflow.com/q/9383593/6495043\n\n\tif(x===0) {\n\t\treturn [0, 0];\n\t}\n\tif(isNaN(x)) {\n\t\treturn {mantissa: -6755399441055744, exponent: 972};\n\t}\n\tvar sig = x > 0 ? 1 : -1;\n\tif(!isFinite(x)) {\n\t\treturn {mantissa: sig * 4503599627370496, exponent: 972};\n\t}\n\n\tx = Math.abs(x);\n\tvar exp = Math.floor(Math.log10(x));\n\tvar man = x/Math.pow(10, exp);\n\n\treturn [sig * man, exp];\n}\n\nfunction getChartRangeIntervals(max, min=0) {\n\tlet upperBound = Math.ceil(max);\n\tlet lowerBound = Math.floor(min);\n\tlet range = upperBound - lowerBound;\n\n\tlet noOfParts = range;\n\tlet partSize = 1;\n\n\t// To avoid too many partitions\n\tif(range > 5) {\n\t\tif(range % 2 !== 0) {\n\t\t\tupperBound++;\n\t\t\t// Recalc range\n\t\t\trange = upperBound - lowerBound;\n\t\t}\n\t\tnoOfParts = range/2;\n\t\tpartSize = 2;\n\t}\n\n\t// Special case: 1 and 2\n\tif(range <= 2) {\n\t\tnoOfParts = 4;\n\t\tpartSize = range/noOfParts;\n\t}\n\n\t// Special case: 0\n\tif(range === 0) {\n\t\tnoOfParts = 5;\n\t\tpartSize = 1;\n\t}\n\n\tlet intervals = [];\n\tfor(var i = 0; i <= noOfParts; i++){\n\t\tintervals.push(lowerBound + partSize * i);\n\t}\n\treturn intervals;\n}\n\nfunction getChartIntervals(maxValue, minValue=0) {\n\tlet [normalMaxValue, exponent] = normalize(maxValue);\n\tlet normalMinValue = minValue ? minValue/Math.pow(10, exponent): 0;\n\n\t// Allow only 7 significant digits\n\tnormalMaxValue = normalMaxValue.toFixed(6);\n\n\tlet intervals = getChartRangeIntervals(normalMaxValue, normalMinValue);\n\tintervals = intervals.map(value => value * Math.pow(10, exponent));\n\treturn intervals;\n}\n\nfunction calcChartIntervals(values, withMinimum=false) {\n\t//*** Where the magic happens ***\n\n\t// Calculates best-fit y intervals from given values\n\t// and returns the interval array\n\n\tlet maxValue = Math.max(...values);\n\tlet minValue = Math.min(...values);\n\n\t// Exponent to be used for pretty print\n\tlet exponent = 0, intervals = []; // eslint-disable-line no-unused-vars\n\n\tfunction getPositiveFirstIntervals(maxValue, absMinValue) {\n\t\tlet intervals = getChartIntervals(maxValue);\n\n\t\tlet intervalSize = intervals[1] - intervals[0];\n\n\t\t// Then unshift the negative values\n\t\tlet value = 0;\n\t\tfor(var i = 1; value < absMinValue; i++) {\n\t\t\tvalue += intervalSize;\n\t\t\tintervals.unshift((-1) * value);\n\t\t}\n\t\treturn intervals;\n\t}\n\n\t// CASE I: Both non-negative\n\n\tif(maxValue >= 0 && minValue >= 0) {\n\t\texponent = normalize(maxValue)[1];\n\t\tif(!withMinimum) {\n\t\t\tintervals = getChartIntervals(maxValue);\n\t\t} else {\n\t\t\tintervals = getChartIntervals(maxValue, minValue);\n\t\t}\n\t}\n\n\t// CASE II: Only minValue negative\n\n\telse if(maxValue > 0 && minValue < 0) {\n\t\t// `withMinimum` irrelevant in this case,\n\t\t// We'll be handling both sides of zero separately\n\t\t// (both starting from zero)\n\t\t// Because ceil() and floor() behave differently\n\t\t// in those two regions\n\n\t\tlet absMinValue = Math.abs(minValue);\n\n\t\tif(maxValue >= absMinValue) {\n\t\t\texponent = normalize(maxValue)[1];\n\t\t\tintervals = getPositiveFirstIntervals(maxValue, absMinValue);\n\t\t} else {\n\t\t\t// Mirror: maxValue => absMinValue, then change sign\n\t\t\texponent = normalize(absMinValue)[1];\n\t\t\tlet posIntervals = getPositiveFirstIntervals(absMinValue, maxValue);\n\t\t\tintervals = posIntervals.map(d => d * (-1));\n\t\t}\n\n\t}\n\n\t// CASE III: Both non-positive\n\n\telse if(maxValue <= 0 && minValue <= 0) {\n\t\t// Mirrored Case I:\n\t\t// Work with positives, then reverse the sign and array\n\n\t\tlet pseudoMaxValue = Math.abs(minValue);\n\t\tlet pseudoMinValue = Math.abs(maxValue);\n\n\t\texponent = normalize(pseudoMaxValue)[1];\n\t\tif(!withMinimum) {\n\t\t\tintervals = getChartIntervals(pseudoMaxValue);\n\t\t} else {\n\t\t\tintervals = getChartIntervals(pseudoMaxValue, pseudoMinValue);\n\t\t}\n\n\t\tintervals = intervals.reverse().map(d => d * (-1));\n\t}\n\n\treturn intervals;\n}\n\nfunction getZeroIndex(yPts) {\n\tlet zeroIndex;\n\tlet interval = getIntervalSize(yPts);\n\tif(yPts.indexOf(0) >= 0) {\n\t\t// the range has a given zero\n\t\t// zero-line on the chart\n\t\tzeroIndex = yPts.indexOf(0);\n\t} else if(yPts[0] > 0) {\n\t\t// Minimum value is positive\n\t\t// zero-line is off the chart: below\n\t\tlet min = yPts[0];\n\t\tzeroIndex = (-1) * min / interval;\n\t} else {\n\t\t// Maximum value is negative\n\t\t// zero-line is off the chart: above\n\t\tlet max = yPts[yPts.length - 1];\n\t\tzeroIndex = (-1) * max / interval + (yPts.length - 1);\n\t}\n\treturn zeroIndex;\n}\n\n\n\nfunction getIntervalSize(orderedArray) {\n\treturn orderedArray[1] - orderedArray[0];\n}\n\nfunction getValueRange(orderedArray) {\n\treturn orderedArray[orderedArray.length-1] - orderedArray[0];\n}\n\nfunction scale(val, yAxis) {\n\treturn floatTwo(yAxis.zeroLine - val * yAxis.scaleMultiplier);\n}\n\n\n\n\n\nfunction getClosestInArray(goal, arr, index = false) {\n\tlet closest = arr.reduce(function(prev, curr) {\n\t\treturn (Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev);\n\t}, []);\n\n\treturn index ? arr.indexOf(closest) : closest;\n}\n\nfunction calcDistribution(values, distributionSize) {\n\t// Assume non-negative values,\n\t// implying distribution minimum at zero\n\n\tlet dataMaxValue = Math.max(...values);\n\n\tlet distributionStep = 1 / (distributionSize - 1);\n\tlet distribution = [];\n\n\tfor(var i = 0; i < distributionSize; i++) {\n\t\tlet checkpoint = dataMaxValue * (distributionStep * i);\n\t\tdistribution.push(checkpoint);\n\t}\n\n\treturn distribution;\n}\n\nfunction getMaxCheckpoint(value, distribution) {\n\treturn distribution.filter(d => d < value).length;\n}\n\nconst COL_WIDTH = HEATMAP_SQUARE_SIZE + HEATMAP_GUTTER_SIZE;\nconst ROW_HEIGHT = COL_WIDTH;\n// const DAY_INCR = 1;\n\nclass Heatmap extends BaseChart {\n\tconstructor(parent, options) {\n\t\tsuper(parent, options);\n\t\tthis.type = 'heatmap';\n\n\t\tthis.countLabel = options.countLabel || '';\n\n\t\tlet validStarts = ['Sunday', 'Monday'];\n\t\tlet startSubDomain = validStarts.includes(options.startSubDomain)\n\t\t\t? options.startSubDomain : 'Sunday';\n\t\tthis.startSubDomainIndex = validStarts.indexOf(startSubDomain);\n\n\t\tthis.setup();\n\t}\n\n\tsetMeasures(options) {\n\t\tlet m = this.measures;\n\t\tthis.discreteDomains = options.discreteDomains === 0 ? 0 : 1;\n\n\t\tm.paddings.top = ROW_HEIGHT * 3;\n\t\tm.paddings.bottom = 0;\n\t\tm.legendHeight = ROW_HEIGHT * 2;\n\t\tm.baseHeight = ROW_HEIGHT * NO_OF_DAYS_IN_WEEK\n\t\t\t+ getExtraHeight(m);\n\n\t\tlet d = this.data;\n\t\tlet spacing = this.discreteDomains ? NO_OF_YEAR_MONTHS : 0;\n\t\tthis.independentWidth = (getWeeksBetween(d.start, d.end)\n\t\t\t+ spacing) * COL_WIDTH + getExtraWidth(m);\n\t}\n\n\tupdateWidth() {\n\t\tlet spacing = this.discreteDomains ? NO_OF_YEAR_MONTHS : 0;\n\t\tlet noOfWeeks = this.state.noOfWeeks ? this.state.noOfWeeks : 52;\n\t\tthis.baseWidth = (noOfWeeks + spacing) * COL_WIDTH\n\t\t\t+ getExtraWidth(this.measures);\n\t}\n\n\tprepareData(data=this.data) {\n\t\tif(data.start && data.end && data.start > data.end) {\n\t\t\tthrow new Error('Start date cannot be greater than end date.');\n\t\t}\n\n\t\tif(!data.start) {\n\t\t\tdata.start = new Date();\n\t\t\tdata.start.setFullYear( data.start.getFullYear() - 1 );\n\t\t}\n\t\tif(!data.end) { data.end = new Date(); }\n\t\tdata.dataPoints = data.dataPoints || {};\n\n\t\tif(parseInt(Object.keys(data.dataPoints)[0]) > 100000) {\n\t\t\tlet points = {};\n\t\t\tObject.keys(data.dataPoints).forEach(timestampSec$$1 => {\n\t\t\t\tlet date = new Date(timestampSec$$1 * NO_OF_MILLIS);\n\t\t\t\tpoints[getYyyyMmDd(date)] = data.dataPoints[timestampSec$$1];\n\t\t\t});\n\t\t\tdata.dataPoints = points;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tcalc() {\n\t\tlet s = this.state;\n\n\t\ts.start = clone(this.data.start);\n\t\ts.end = clone(this.data.end);\n\n\t\ts.firstWeekStart = clone(s.start);\n\t\ts.noOfWeeks = getWeeksBetween(s.start, s.end);\n\t\ts.distribution = calcDistribution(\n\t\t\tObject.values(this.data.dataPoints), HEATMAP_DISTRIBUTION_SIZE);\n\n\t\ts.domainConfigs = this.getDomains();\n\t}\n\n\tsetupComponents() {\n\t\tlet s = this.state;\n\t\tlet lessCol = this.discreteDomains ? 0 : 1;\n\n\t\tlet componentConfigs = s.domainConfigs.map((config, i) => [\n\t\t\t'heatDomain',\n\t\t\t{\n\t\t\t\tindex: config.index,\n\t\t\t\tcolWidth: COL_WIDTH,\n\t\t\t\trowHeight: ROW_HEIGHT,\n\t\t\t\tsquareSize: HEATMAP_SQUARE_SIZE,\n\t\t\t\tradius: this.rawChartArgs.radius || 0,\n\t\t\t\txTranslate: s.domainConfigs\n\t\t\t\t\t.filter((config, j) => j < i)\n\t\t\t\t\t.map(config => config.cols.length - lessCol)\n\t\t\t\t\t.reduce((a, b) => a + b, 0)\n\t\t\t\t\t* COL_WIDTH\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\treturn s.domainConfigs[i];\n\t\t\t}.bind(this)\n\n\t\t]);\n\n\t\tthis.components = new Map(componentConfigs\n\t\t\t.map((args, i) => {\n\t\t\t\tlet component = getComponent(...args);\n\t\t\t\treturn [args[0] + '-' + i, component];\n\t\t\t})\n\t\t);\n\n\t\tlet y = 0;\n\t\tDAY_NAMES_SHORT.forEach((dayName, i) => {\n\t\t\tif([1, 3, 5].includes(i)) {\n\t\t\t\tlet dayText = makeText('subdomain-name', -COL_WIDTH/2, y, dayName,\n\t\t\t\t\t{\n\t\t\t\t\t\tfontSize: HEATMAP_SQUARE_SIZE,\n\t\t\t\t\t\tdy: 8,\n\t\t\t\t\t\ttextAnchor: 'end'\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tthis.drawArea.appendChild(dayText);\n\t\t\t}\n\t\t\ty += ROW_HEIGHT;\n\t\t});\n\t}\n\n\tupdate(data) {\n\t\tif(!data) {\n\t\t\tconsole.error('No data to update.');\n\t\t}\n\n\t\tthis.data = this.prepareData(data);\n\t\tthis.draw();\n\t\tthis.bindTooltip();\n\t}\n\n\tbindTooltip() {\n\t\tthis.container.addEventListener('mousemove', (e) => {\n\t\t\tthis.components.forEach(comp => {\n\t\t\t\tlet daySquares = comp.store;\n\t\t\t\tlet daySquare = e.target;\n\t\t\t\tif(daySquares.includes(daySquare)) {\n\n\t\t\t\t\tlet count = daySquare.getAttribute('data-value');\n\t\t\t\t\tlet dateParts = daySquare.getAttribute('data-date').split('-');\n\n\t\t\t\t\tlet month = getMonthName(parseInt(dateParts[1])-1, true);\n\n\t\t\t\t\tlet gOff = this.container.getBoundingClientRect(), pOff = daySquare.getBoundingClientRect();\n\n\t\t\t\t\tlet width = parseInt(e.target.getAttribute('width'));\n\t\t\t\t\tlet x = pOff.left - gOff.left + width/2;\n\t\t\t\t\tlet y = pOff.top - gOff.top;\n\t\t\t\t\tlet value = count + ' ' + this.countLabel;\n\t\t\t\t\tlet name = ' on ' + month + ' ' + dateParts[0] + ', ' + dateParts[2];\n\n\t\t\t\t\tthis.tip.setValues(x, y, {name: name, value: value, valueFirst: 1}, []);\n\t\t\t\t\tthis.tip.showTip();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\trenderLegend() {\n\t\tthis.legendArea.textContent = '';\n\t\tlet x = 0;\n\t\tlet y = ROW_HEIGHT;\n\t\tlet radius = this.rawChartArgs.radius || 0;\n\n\t\tlet lessText = makeText('subdomain-name', x, y, 'Less',\n\t\t\t{\n\t\t\t\tfontSize: HEATMAP_SQUARE_SIZE + 1,\n\t\t\t\tdy: 9\n\t\t\t}\n\t\t);\n\t\tx = (COL_WIDTH * 2) + COL_WIDTH/2;\n\t\tthis.legendArea.appendChild(lessText);\n\n\t\tthis.colors.slice(0, HEATMAP_DISTRIBUTION_SIZE).map((color, i) => {\n\t\t\tconst square = heatSquare('heatmap-legend-unit', x + (COL_WIDTH + 3) * i,\n\t\t\t\ty, HEATMAP_SQUARE_SIZE, radius, color);\n\t\t\tthis.legendArea.appendChild(square);\n\t\t});\n\n\t\tlet moreTextX = x + HEATMAP_DISTRIBUTION_SIZE * (COL_WIDTH + 3) + COL_WIDTH/4;\n\t\tlet moreText = makeText('subdomain-name', moreTextX, y, 'More',\n\t\t\t{\n\t\t\t\tfontSize: HEATMAP_SQUARE_SIZE + 1,\n\t\t\t\tdy: 9\n\t\t\t}\n\t\t);\n\t\tthis.legendArea.appendChild(moreText);\n\t}\n\n\tgetDomains() {\n\t\tlet s = this.state;\n\t\tconst [startMonth, startYear] = [s.start.getMonth(), s.start.getFullYear()];\n\t\tconst [endMonth, endYear] = [s.end.getMonth(), s.end.getFullYear()];\n\n\t\tconst noOfMonths = (endMonth - startMonth + 1) + (endYear - startYear) * 12;\n\n\t\tlet domainConfigs = [];\n\n\t\tlet startOfMonth = clone(s.start);\n\t\tfor(var i = 0; i < noOfMonths; i++) {\n\t\t\tlet endDate = s.end;\n\t\t\tif(!areInSameMonth(startOfMonth, s.end)) {\n\t\t\t\tlet [month, year] = [startOfMonth.getMonth(), startOfMonth.getFullYear()];\n\t\t\t\tendDate = getLastDateInMonth(month, year);\n\t\t\t}\n\t\t\tdomainConfigs.push(this.getDomainConfig(startOfMonth, endDate));\n\n\t\t\taddDays(endDate, 1);\n\t\t\tstartOfMonth = endDate;\n\t\t}\n\n\t\treturn domainConfigs;\n\t}\n\n\tgetDomainConfig(startDate, endDate='') {\n\t\tlet [month, year] = [startDate.getMonth(), startDate.getFullYear()];\n\t\tlet startOfWeek = setDayToSunday(startDate); // TODO: Monday as well\n\t\tendDate = clone(endDate) || getLastDateInMonth(month, year);\n\n\t\tlet domainConfig = {\n\t\t\tindex: month,\n\t\t\tcols: []\n\t\t};\n\n\t\taddDays(endDate, 1);\n\t\tlet noOfMonthWeeks = getWeeksBetween(startOfWeek, endDate);\n\n\t\tlet cols = [], col;\n\t\tfor(var i = 0; i < noOfMonthWeeks; i++) {\n\t\t\tcol = this.getCol(startOfWeek, month);\n\t\t\tcols.push(col);\n\n\t\t\tstartOfWeek = new Date(col[NO_OF_DAYS_IN_WEEK - 1].yyyyMmDd);\n\t\t\taddDays(startOfWeek, 1);\n\t\t}\n\n\t\tif(col[NO_OF_DAYS_IN_WEEK - 1].dataValue !== undefined) {\n\t\t\taddDays(startOfWeek, 1);\n\t\t\tcols.push(this.getCol(startOfWeek, month, true));\n\t\t}\n\n\t\tdomainConfig.cols = cols;\n\n\t\treturn domainConfig;\n\t}\n\n\tgetCol(startDate, month, empty = false) {\n\t\tlet s = this.state;\n\n\t\t// startDate is the start of week\n\t\tlet currentDate = clone(startDate);\n\t\tlet col = [];\n\n\t\tfor(var i = 0; i < NO_OF_DAYS_IN_WEEK; i++, addDays(currentDate, 1)) {\n\t\t\tlet config = {};\n\n\t\t\t// Non-generic adjustment for entire heatmap, needs state\n\t\t\tlet currentDateWithinData = currentDate >= s.start && currentDate <= s.end;\n\n\t\t\tif(empty || currentDate.getMonth() !== month || !currentDateWithinData) {\n\t\t\t\tconfig.yyyyMmDd = getYyyyMmDd(currentDate);\n\t\t\t} else {\n\t\t\t\tconfig = this.getSubDomainConfig(currentDate);\n\t\t\t}\n\t\t\tcol.push(config);\n\t\t}\n\n\t\treturn col;\n\t}\n\n\tgetSubDomainConfig(date) {\n\t\tlet yyyyMmDd = getYyyyMmDd(date);\n\t\tlet dataValue = this.data.dataPoints[yyyyMmDd];\n\t\tlet config = {\n\t\t\tyyyyMmDd: yyyyMmDd,\n\t\t\tdataValue: dataValue || 0,\n\t\t\tfill: this.colors[getMaxCheckpoint(dataValue, this.state.distribution)]\n\t\t};\n\t\treturn config;\n\t}\n}\n\nfunction dataPrep(data, type) {\n\tdata.labels = data.labels || [];\n\n\tlet datasetLength = data.labels.length;\n\n\t// Datasets\n\tlet datasets = data.datasets;\n\tlet zeroArray = new Array(datasetLength).fill(0);\n\tif(!datasets) {\n\t\t// default\n\t\tdatasets = [{\n\t\t\tvalues: zeroArray\n\t\t}];\n\t}\n\n\tdatasets.map(d=> {\n\t\t// Set values\n\t\tif(!d.values) {\n\t\t\td.values = zeroArray;\n\t\t} else {\n\t\t\t// Check for non values\n\t\t\tlet vals = d.values;\n\t\t\tvals = vals.map(val => (!isNaN(val) ? val : 0));\n\n\t\t\t// Trim or extend\n\t\t\tif(vals.length > datasetLength) {\n\t\t\t\tvals = vals.slice(0, datasetLength);\n\t\t\t} else {\n\t\t\t\tvals = fillArray(vals, datasetLength - vals.length, 0);\n\t\t\t}\n\t\t}\n\n\t\t// Set labels\n\t\t//\n\n\t\t// Set type\n\t\tif(!d.chartType ) {\n\t\t\tif(!AXIS_DATASET_CHART_TYPES.includes(type)) type === DEFAULT_AXIS_CHART_TYPE;\n\t\t\td.chartType = type;\n\t\t}\n\n\t});\n\n\t// Markers\n\n\t// Regions\n\t// data.yRegions = data.yRegions || [];\n\tif(data.yRegions) {\n\t\tdata.yRegions.map(d => {\n\t\t\tif(d.end < d.start) {\n\t\t\t\t[d.start, d.end] = [d.end, d.start];\n\t\t\t}\n\t\t});\n\t}\n\n\treturn data;\n}\n\nfunction zeroDataPrep(realData) {\n\tlet datasetLength = realData.labels.length;\n\tlet zeroArray = new Array(datasetLength).fill(0);\n\n\tlet zeroData = {\n\t\tlabels: realData.labels.slice(0, -1),\n\t\tdatasets: realData.datasets.map(d => {\n\t\t\treturn {\n\t\t\t\tname: '',\n\t\t\t\tvalues: zeroArray.slice(0, -1),\n\t\t\t\tchartType: d.chartType\n\t\t\t};\n\t\t}),\n\t};\n\n\tif(realData.yMarkers) {\n\t\tzeroData.yMarkers = [\n\t\t\t{\n\t\t\t\tvalue: 0,\n\t\t\t\tlabel: ''\n\t\t\t}\n\t\t];\n\t}\n\n\tif(realData.yRegions) {\n\t\tzeroData.yRegions = [\n\t\t\t{\n\t\t\t\tstart: 0,\n\t\t\t\tend: 0,\n\t\t\t\tlabel: ''\n\t\t\t}\n\t\t];\n\t}\n\n\treturn zeroData;\n}\n\nfunction getShortenedLabels(chartWidth, labels=[], isSeries=true) {\n\tlet allowedSpace = chartWidth / labels.length;\n\tif(allowedSpace <= 0) allowedSpace = 1;\n\tlet allowedLetters = allowedSpace / DEFAULT_CHAR_WIDTH;\n\n\tlet seriesMultiple;\n\tif(isSeries) {\n\t\t// Find the maximum label length for spacing calculations\n\t\tlet maxLabelLength = Math.max(...labels.map(label => label.length));\n\t\tseriesMultiple = Math.ceil(maxLabelLength/allowedLetters);\n\t}\n\n\tlet calcLabels = labels.map((label, i) => {\n\t\tlabel += \"\";\n\t\tif(label.length > allowedLetters) {\n\n\t\t\tif(!isSeries) {\n\t\t\t\tif(allowedLetters-3 > 0) {\n\t\t\t\t\tlabel = label.slice(0, allowedLetters-3) + \" ...\";\n\t\t\t\t} else {\n\t\t\t\t\tlabel = label.slice(0, allowedLetters) + '..';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(i % seriesMultiple !== 0) {\n\t\t\t\t\tlabel = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn label;\n\t});\n\n\treturn calcLabels;\n}\n\nclass AxisChart extends BaseChart {\n\tconstructor(parent, args) {\n\t\tsuper(parent, args);\n\n\t\tthis.barOptions = args.barOptions || {};\n\t\tthis.lineOptions = args.lineOptions || {};\n\n\t\tthis.type = args.type || 'line';\n\t\tthis.init = 1;\n\n\t\tthis.setup();\n\t}\n\n\tsetMeasures() {\n\t\tif(this.data.datasets.length <= 1) {\n\t\t\tthis.config.showLegend = 0;\n\t\t\tthis.measures.paddings.bottom = 30;\n\t\t}\n\t}\n\n\tconfigure(options) {\n\t\tsuper.configure(options);\n\n\t\toptions.axisOptions = options.axisOptions || {};\n\t\toptions.tooltipOptions = options.tooltipOptions || {};\n\n\t\tthis.config.xAxisMode = options.axisOptions.xAxisMode || 'span';\n\t\tthis.config.yAxisMode = options.axisOptions.yAxisMode || 'span';\n\t\tthis.config.xIsSeries = options.axisOptions.xIsSeries || 0;\n\t\tthis.config.shortenYAxisNumbers = options.axisOptions.shortenYAxisNumbers || 0;\n\n\t\tthis.config.formatTooltipX = options.tooltipOptions.formatTooltipX;\n\t\tthis.config.formatTooltipY = options.tooltipOptions.formatTooltipY;\n\n\t\tthis.config.valuesOverPoints = options.valuesOverPoints;\n\t}\n\n\tprepareData(data=this.data) {\n\t\treturn dataPrep(data, this.type);\n\t}\n\n\tprepareFirstData(data=this.data) {\n\t\treturn zeroDataPrep(data);\n\t}\n\n\tcalc(onlyWidthChange = false) {\n\t\tthis.calcXPositions();\n\t\tif(!onlyWidthChange) {\n\t\t\tthis.calcYAxisParameters(this.getAllYValues(), this.type === 'line');\n\t\t}\n\t\tthis.makeDataByIndex();\n\t}\n\n\tcalcXPositions() {\n\t\tlet s = this.state;\n\t\tlet labels = this.data.labels;\n\t\ts.datasetLength = labels.length;\n\n\t\ts.unitWidth = this.width/(s.datasetLength);\n\t\t// Default, as per bar, and mixed. Only line will be a special case\n\t\ts.xOffset = s.unitWidth/2;\n\n\t\t// // For a pure Line Chart\n\t\t// s.unitWidth = this.width/(s.datasetLength - 1);\n\t\t// s.xOffset = 0;\n\n\t\ts.xAxis = {\n\t\t\tlabels: labels,\n\t\t\tpositions: labels.map((d, i) =>\n\t\t\t\tfloatTwo(s.xOffset + i * s.unitWidth)\n\t\t\t)\n\t\t};\n\t}\n\n\tcalcYAxisParameters(dataValues, withMinimum = 'false') {\n\t\tconst yPts = calcChartIntervals(dataValues, withMinimum);\n\t\tconst scaleMultiplier = this.height / getValueRange(yPts);\n\t\tconst intervalHeight = getIntervalSize(yPts) * scaleMultiplier;\n\t\tconst zeroLine = this.height - (getZeroIndex(yPts) * intervalHeight);\n\n\t\tthis.state.yAxis = {\n\t\t\tlabels: yPts,\n\t\t\tpositions: yPts.map(d => zeroLine - d * scaleMultiplier),\n\t\t\tscaleMultiplier: scaleMultiplier,\n\t\t\tzeroLine: zeroLine,\n\t\t};\n\n\t\t// Dependent if above changes\n\t\tthis.calcDatasetPoints();\n\t\tthis.calcYExtremes();\n\t\tthis.calcYRegions();\n\t}\n\n\tcalcDatasetPoints() {\n\t\tlet s = this.state;\n\t\tlet scaleAll = values => values.map(val => scale(val, s.yAxis));\n\n\t\ts.datasets = this.data.datasets.map((d, i) => {\n\t\t\tlet values = d.values;\n\t\t\tlet cumulativeYs = d.cumulativeYs || [];\n\t\t\treturn {\n\t\t\t\tname: d.name,\n\t\t\t\tindex: i,\n\t\t\t\tchartType: d.chartType,\n\n\t\t\t\tvalues: values,\n\t\t\t\tyPositions: scaleAll(values),\n\n\t\t\t\tcumulativeYs: cumulativeYs,\n\t\t\t\tcumulativeYPos: scaleAll(cumulativeYs),\n\t\t\t};\n\t\t});\n\t}\n\n\tcalcYExtremes() {\n\t\tlet s = this.state;\n\t\tif(this.barOptions.stacked) {\n\t\t\ts.yExtremes = s.datasets[s.datasets.length - 1].cumulativeYPos;\n\t\t\treturn;\n\t\t}\n\t\ts.yExtremes = new Array(s.datasetLength).fill(9999);\n\t\ts.datasets.map(d => {\n\t\t\td.yPositions.map((pos, j) => {\n\t\t\t\tif(pos < s.yExtremes[j]) {\n\t\t\t\t\ts.yExtremes[j] = pos;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tcalcYRegions() {\n\t\tlet s = this.state;\n\t\tif(this.data.yMarkers) {\n\t\t\tthis.state.yMarkers = this.data.yMarkers.map(d => {\n\t\t\t\td.position = scale(d.value, s.yAxis);\n\t\t\t\tif(!d.options) d.options = {};\n\t\t\t\t// if(!d.label.includes(':')) {\n\t\t\t\t// \td.label += ': ' + d.value;\n\t\t\t\t// }\n\t\t\t\treturn d;\n\t\t\t});\n\t\t}\n\t\tif(this.data.yRegions) {\n\t\t\tthis.state.yRegions = this.data.yRegions.map(d => {\n\t\t\t\td.startPos = scale(d.start, s.yAxis);\n\t\t\t\td.endPos = scale(d.end, s.yAxis);\n\t\t\t\tif(!d.options) d.options = {};\n\t\t\t\treturn d;\n\t\t\t});\n\t\t}\n\t}\n\n\tgetAllYValues() {\n\t\tlet key = 'values';\n\n\t\tif(this.barOptions.stacked) {\n\t\t\tkey = 'cumulativeYs';\n\t\t\tlet cumulative = new Array(this.state.datasetLength).fill(0);\n\t\t\tthis.data.datasets.map((d, i) => {\n\t\t\t\tlet values = this.data.datasets[i].values;\n\t\t\t\td[key] = cumulative = cumulative.map((c, i) => c + values[i]);\n\t\t\t});\n\t\t}\n\n\t\tlet allValueLists = this.data.datasets.map(d => d[key]);\n\t\tif(this.data.yMarkers) {\n\t\t\tallValueLists.push(this.data.yMarkers.map(d => d.value));\n\t\t}\n\t\tif(this.data.yRegions) {\n\t\t\tthis.data.yRegions.map(d => {\n\t\t\t\tallValueLists.push([d.end, d.start]);\n\t\t\t});\n\t\t}\n\n\t\treturn [].concat(...allValueLists);\n\t}\n\n\tsetupComponents() {\n\t\tlet componentConfigs = [\n\t\t\t[\n\t\t\t\t'yAxis',\n\t\t\t\t{\n\t\t\t\t\tmode: this.config.yAxisMode,\n\t\t\t\t\twidth: this.width,\n\t\t\t\t\tshortenNumbers: this.config.shortenYAxisNumbers\n\t\t\t\t\t// pos: 'right'\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\treturn this.state.yAxis;\n\t\t\t\t}.bind(this)\n\t\t\t],\n\n\t\t\t[\n\t\t\t\t'xAxis',\n\t\t\t\t{\n\t\t\t\t\tmode: this.config.xAxisMode,\n\t\t\t\t\theight: this.height,\n\t\t\t\t\t// pos: 'right'\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\tlet s = this.state;\n\t\t\t\t\ts.xAxis.calcLabels = getShortenedLabels(this.width,\n\t\t\t\t\t\ts.xAxis.labels, this.config.xIsSeries);\n\n\t\t\t\t\treturn s.xAxis;\n\t\t\t\t}.bind(this)\n\t\t\t],\n\n\t\t\t[\n\t\t\t\t'yRegions',\n\t\t\t\t{\n\t\t\t\t\twidth: this.width,\n\t\t\t\t\tpos: 'right'\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\treturn this.state.yRegions;\n\t\t\t\t}.bind(this)\n\t\t\t],\n\t\t];\n\n\t\tlet barDatasets = this.state.datasets.filter(d => d.chartType === 'bar');\n\t\tlet lineDatasets = this.state.datasets.filter(d => d.chartType === 'line');\n\n\t\tlet barsConfigs = barDatasets.map(d => {\n\t\t\tlet index = d.index;\n\t\t\treturn [\n\t\t\t\t'barGraph' + '-' + d.index,\n\t\t\t\t{\n\t\t\t\t\tindex: index,\n\t\t\t\t\tcolor: this.colors[index],\n\t\t\t\t\tstacked: this.barOptions.stacked,\n\n\t\t\t\t\t// same for all datasets\n\t\t\t\t\tvaluesOverPoints: this.config.valuesOverPoints,\n\t\t\t\t\tminHeight: this.height * MIN_BAR_PERCENT_HEIGHT,\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\tlet s = this.state;\n\t\t\t\t\tlet d = s.datasets[index];\n\t\t\t\t\tlet stacked = this.barOptions.stacked;\n\n\t\t\t\t\tlet spaceRatio = this.barOptions.spaceRatio || BAR_CHART_SPACE_RATIO;\n\t\t\t\t\tlet barsWidth = s.unitWidth * (1 - spaceRatio);\n\t\t\t\t\tlet barWidth = barsWidth/(stacked ? 1 : barDatasets.length);\n\n\t\t\t\t\tlet xPositions = s.xAxis.positions.map(x => x - barsWidth/2);\n\t\t\t\t\tif(!stacked) {\n\t\t\t\t\t\txPositions = xPositions.map(p => p + barWidth * index);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet labels = new Array(s.datasetLength).fill('');\n\t\t\t\t\tif(this.config.valuesOverPoints) {\n\t\t\t\t\t\tif(stacked && d.index === s.datasets.length - 1) {\n\t\t\t\t\t\t\tlabels = d.cumulativeYs;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlabels = d.values;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet offsets = new Array(s.datasetLength).fill(0);\n\t\t\t\t\tif(stacked) {\n\t\t\t\t\t\toffsets = d.yPositions.map((y, j) => y - d.cumulativeYPos[j]);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\txPositions: xPositions,\n\t\t\t\t\t\tyPositions: d.yPositions,\n\t\t\t\t\t\toffsets: offsets,\n\t\t\t\t\t\t// values: d.values,\n\t\t\t\t\t\tlabels: labels,\n\n\t\t\t\t\t\tzeroLine: s.yAxis.zeroLine,\n\t\t\t\t\t\tbarsWidth: barsWidth,\n\t\t\t\t\t\tbarWidth: barWidth,\n\t\t\t\t\t};\n\t\t\t\t}.bind(this)\n\t\t\t];\n\t\t});\n\n\t\tlet lineConfigs = lineDatasets.map(d => {\n\t\t\tlet index = d.index;\n\t\t\treturn [\n\t\t\t\t'lineGraph' + '-' + d.index,\n\t\t\t\t{\n\t\t\t\t\tindex: index,\n\t\t\t\t\tcolor: this.colors[index],\n\t\t\t\t\tsvgDefs: this.svgDefs,\n\t\t\t\t\theatline: this.lineOptions.heatline,\n\t\t\t\t\tregionFill: this.lineOptions.regionFill,\n\t\t\t\t\tspline: this.lineOptions.spline,\n\t\t\t\t\thideDots: this.lineOptions.hideDots,\n\t\t\t\t\thideLine: this.lineOptions.hideLine,\n\n\t\t\t\t\t// same for all datasets\n\t\t\t\t\tvaluesOverPoints: this.config.valuesOverPoints,\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\tlet s = this.state;\n\t\t\t\t\tlet d = s.datasets[index];\n\t\t\t\t\tlet minLine = s.yAxis.positions[0] < s.yAxis.zeroLine\n\t\t\t\t\t\t? s.yAxis.positions[0] : s.yAxis.zeroLine;\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\txPositions: s.xAxis.positions,\n\t\t\t\t\t\tyPositions: d.yPositions,\n\n\t\t\t\t\t\tvalues: d.values,\n\n\t\t\t\t\t\tzeroLine: minLine,\n\t\t\t\t\t\tradius: this.lineOptions.dotSize || LINE_CHART_DOT_SIZE,\n\t\t\t\t\t};\n\t\t\t\t}.bind(this)\n\t\t\t];\n\t\t});\n\n\t\tlet markerConfigs = [\n\t\t\t[\n\t\t\t\t'yMarkers',\n\t\t\t\t{\n\t\t\t\t\twidth: this.width,\n\t\t\t\t\tpos: 'right'\n\t\t\t\t},\n\t\t\t\tfunction() {\n\t\t\t\t\treturn this.state.yMarkers;\n\t\t\t\t}.bind(this)\n\t\t\t]\n\t\t];\n\n\t\tcomponentConfigs = componentConfigs.concat(barsConfigs, lineConfigs, markerConfigs);\n\n\t\tlet optionals = ['yMarkers', 'yRegions'];\n\t\tthis.dataUnitComponents = [];\n\n\t\tthis.components = new Map(componentConfigs\n\t\t\t.filter(args => !optionals.includes(args[0]) || this.state[args[0]])\n\t\t\t.map(args => {\n\t\t\t\tlet component = getComponent(...args);\n\t\t\t\tif(args[0].includes('lineGraph') || args[0].includes('barGraph')) {\n\t\t\t\t\tthis.dataUnitComponents.push(component);\n\t\t\t\t}\n\t\t\t\treturn [args[0], component];\n\t\t\t}));\n\t}\n\n\tmakeDataByIndex() {\n\t\tthis.dataByIndex = {};\n\n\t\tlet s = this.state;\n\t\tlet formatX = this.config.formatTooltipX;\n\t\tlet formatY = this.config.formatTooltipY;\n\t\tlet titles = s.xAxis.labels;\n\n\t\ttitles.map((label, index) => {\n\t\t\tlet values = this.state.datasets.map((set, i) => {\n\t\t\t\tlet value = set.values[index];\n\t\t\t\treturn {\n\t\t\t\t\ttitle: set.name,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tyPos: set.yPositions[index],\n\t\t\t\t\tcolor: this.colors[i],\n\t\t\t\t\tformatted: formatY ? formatY(value) : value,\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tthis.dataByIndex[index] = {\n\t\t\t\tlabel: label,\n\t\t\t\tformattedLabel: formatX ? formatX(label) : label,\n\t\t\t\txPos: s.xAxis.positions[index],\n\t\t\t\tvalues: values,\n\t\t\t\tyExtreme: s.yExtremes[index],\n\t\t\t};\n\t\t});\n\t}\n\n\tbindTooltip() {\n\t\t// NOTE: could be in tooltip itself, as it is a given functionality for its parent\n\t\tthis.container.addEventListener('mousemove', (e) => {\n\t\t\tlet m = this.measures;\n\t\t\tlet o = getOffset(this.container);\n\t\t\tlet relX = e.pageX - o.left - getLeftOffset(m);\n\t\t\tlet relY = e.pageY - o.top;\n\n\t\t\tif(relY < this.height + getTopOffset(m)\n\t\t\t\t&& relY >  getTopOffset(m)) {\n\t\t\t\tthis.mapTooltipXPosition(relX);\n\t\t\t} else {\n\t\t\t\tthis.tip.hideTip();\n\t\t\t}\n\t\t});\n\t}\n\n\tmapTooltipXPosition(relX) {\n\t\tlet s = this.state;\n\t\tif(!s.yExtremes) return;\n\n\t\tlet index = getClosestInArray(relX, s.xAxis.positions, true);\n\t\tif (index >= 0) {\n\t\t\tlet dbi = this.dataByIndex[index];\n\n\t\t\tthis.tip.setValues(\n\t\t\t\tdbi.xPos + this.tip.offset.x,\n\t\t\t\tdbi.yExtreme + this.tip.offset.y,\n\t\t\t\t{name: dbi.formattedLabel, value: ''},\n\t\t\t\tdbi.values,\n\t\t\t\tindex\n\t\t\t);\n\n\t\t\tthis.tip.showTip();\n\t\t}\n\t}\n\n\trenderLegend() {\n\t\tlet s = this.data;\n\t\tif(s.datasets.length > 1) {\n\t\t\tthis.legendArea.textContent = '';\n\t\t\ts.datasets.map((d, i) => {\n\t\t\t\tlet barWidth = AXIS_LEGEND_BAR_SIZE;\n\t\t\t\t// let rightEndPoint = this.baseWidth - this.measures.margins.left - this.measures.margins.right;\n\t\t\t\t// let multiplier = s.datasets.length - i;\n\t\t\t\tlet rect = legendBar(\n\t\t\t\t\t// rightEndPoint - multiplier * barWidth,\t// To right align\n\t\t\t\t\tbarWidth * i,\n\t\t\t\t\t'0',\n\t\t\t\t\tbarWidth,\n\t\t\t\t\tthis.colors[i],\n\t\t\t\t\td.name,\n\t\t\t\t\tthis.config.truncateLegends);\n\t\t\t\tthis.legendArea.appendChild(rect);\n\t\t\t});\n\t\t}\n\t}\n\n\n\n\t// Overlay\n\tmakeOverlay() {\n\t\tif(this.init) {\n\t\t\tthis.init = 0;\n\t\t\treturn;\n\t\t}\n\t\tif(this.overlayGuides) {\n\t\t\tthis.overlayGuides.forEach(g => {\n\t\t\t\tlet o = g.overlay;\n\t\t\t\to.parentNode.removeChild(o);\n\t\t\t});\n\t\t}\n\n\t\tthis.overlayGuides = this.dataUnitComponents.map(c => {\n\t\t\treturn {\n\t\t\t\ttype: c.unitType,\n\t\t\t\toverlay: undefined,\n\t\t\t\tunits: c.units,\n\t\t\t};\n\t\t});\n\n\t\tif(this.state.currentIndex === undefined) {\n\t\t\tthis.state.currentIndex = this.state.datasetLength - 1;\n\t\t}\n\n\t\t// Render overlays\n\t\tthis.overlayGuides.map(d => {\n\t\t\tlet currentUnit = d.units[this.state.currentIndex];\n\n\t\t\td.overlay = makeOverlay[d.type](currentUnit);\n\t\t\tthis.drawArea.appendChild(d.overlay);\n\t\t});\n\t}\n\n\tupdateOverlayGuides() {\n\t\tif(this.overlayGuides) {\n\t\t\tthis.overlayGuides.forEach(g => {\n\t\t\t\tlet o = g.overlay;\n\t\t\t\to.parentNode.removeChild(o);\n\t\t\t});\n\t\t}\n\t}\n\n\tbindOverlay() {\n\t\tthis.parent.addEventListener('data-select', () => {\n\t\t\tthis.updateOverlay();\n\t\t});\n\t}\n\n\tbindUnits() {\n\t\tthis.dataUnitComponents.map(c => {\n\t\t\tc.units.map(unit => {\n\t\t\t\tunit.addEventListener('click', () => {\n\t\t\t\t\tlet index = unit.getAttribute('data-point-index');\n\t\t\t\t\tthis.setCurrentDataPoint(index);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t// Note: Doesn't work as tooltip is absolutely positioned\n\t\tthis.tip.container.addEventListener('click', () => {\n\t\t\tlet index = this.tip.container.getAttribute('data-point-index');\n\t\t\tthis.setCurrentDataPoint(index);\n\t\t});\n\t}\n\n\tupdateOverlay() {\n\t\tthis.overlayGuides.map(d => {\n\t\t\tlet currentUnit = d.units[this.state.currentIndex];\n\t\t\tupdateOverlay[d.type](currentUnit, d.overlay);\n\t\t});\n\t}\n\n\tonLeftArrow() {\n\t\tthis.setCurrentDataPoint(this.state.currentIndex - 1);\n\t}\n\n\tonRightArrow() {\n\t\tthis.setCurrentDataPoint(this.state.currentIndex + 1);\n\t}\n\n\tgetDataPoint(index=this.state.currentIndex) {\n\t\tlet s = this.state;\n\t\tlet data_point = {\n\t\t\tindex: index,\n\t\t\tlabel: s.xAxis.labels[index],\n\t\t\tvalues: s.datasets.map(d => d.values[index])\n\t\t};\n\t\treturn data_point;\n\t}\n\n\tsetCurrentDataPoint(index) {\n\t\tlet s = this.state;\n\t\tindex = parseInt(index);\n\t\tif(index < 0) index = 0;\n\t\tif(index >= s.xAxis.labels.length) index = s.xAxis.labels.length - 1;\n\t\tif(index === s.currentIndex) return;\n\t\ts.currentIndex = index;\n\t\tfire(this.parent, \"data-select\", this.getDataPoint());\n\t}\n\n\n\n\t// API\n\taddDataPoint(label, datasetValues, index=this.state.datasetLength) {\n\t\tsuper.addDataPoint(label, datasetValues, index);\n\t\tthis.data.labels.splice(index, 0, label);\n\t\tthis.data.datasets.map((d, i) => {\n\t\t\td.values.splice(index, 0, datasetValues[i]);\n\t\t});\n\t\tthis.update(this.data);\n\t}\n\n\tremoveDataPoint(index = this.state.datasetLength-1) {\n\t\tif (this.data.labels.length <= 1) {\n\t\t\treturn;\n\t\t}\n\t\tsuper.removeDataPoint(index);\n\t\tthis.data.labels.splice(index, 1);\n\t\tthis.data.datasets.map(d => {\n\t\t\td.values.splice(index, 1);\n\t\t});\n\t\tthis.update(this.data);\n\t}\n\n\tupdateDataset(datasetValues, index=0) {\n\t\tthis.data.datasets[index].values = datasetValues;\n\t\tthis.update(this.data);\n\t}\n\t// addDataset(dataset, index) {}\n\t// removeDataset(index = 0) {}\n\n\tupdateDatasets(datasets) {\n\t\tthis.data.datasets.map((d, i) => {\n\t\t\tif(datasets[i]) {\n\t\t\t\td.values = datasets[i];\n\t\t\t}\n\t\t});\n\t\tthis.update(this.data);\n\t}\n\n\t// updateDataPoint(dataPoint, index = 0) {}\n\t// addDataPoint(dataPoint, index = 0) {}\n\t// removeDataPoint(index = 0) {}\n}\n\nclass DonutChart extends AggregationChart {\n\tconstructor(parent, args) {\n\t\tsuper(parent, args);\n\t\tthis.type = 'donut';\n\t\tthis.initTimeout = 0;\n\t\tthis.init = 1;\n\n\t\tthis.setup();\n\t}\n\n\tconfigure(args) {\n\t\tsuper.configure(args);\n\t\tthis.mouseMove = this.mouseMove.bind(this);\n\t\tthis.mouseLeave = this.mouseLeave.bind(this);\n\n\t\tthis.hoverRadio = args.hoverRadio || 0.1;\n\t\tthis.config.startAngle = args.startAngle || 0;\n\n\t\tthis.clockWise = args.clockWise || false;\n\t\tthis.strokeWidth = args.strokeWidth || 30;\n\t}\n\n\tcalc() {\n\t\tsuper.calc();\n\t\tlet s = this.state;\n\t\tthis.radius =\n\t\t\tthis.height > this.width\n\t\t\t\t? this.center.x - this.strokeWidth / 2\n\t\t\t\t: this.center.y - this.strokeWidth / 2;\n\n\t\tconst { radius, clockWise } = this;\n\n\t\tconst prevSlicesProperties = s.slicesProperties || [];\n\t\ts.sliceStrings = [];\n\t\ts.slicesProperties = [];\n\t\tlet curAngle = 180 - this.config.startAngle;\n\n\t\ts.sliceTotals.map((total, i) => {\n\t\t\tconst startAngle = curAngle;\n\t\t\tconst originDiffAngle = (total / s.grandTotal) * FULL_ANGLE;\n\t\t\tconst largeArc = originDiffAngle > 180 ? 1: 0;\n\t\t\tconst diffAngle = clockWise ? -originDiffAngle : originDiffAngle;\n\t\t\tconst endAngle = curAngle = curAngle + diffAngle;\n\t\t\tconst startPosition = getPositionByAngle(startAngle, radius);\n\t\t\tconst endPosition = getPositionByAngle(endAngle, radius);\n\n\t\t\tconst prevProperty = this.init && prevSlicesProperties[i];\n\n\t\t\tlet curStart,curEnd;\n\t\t\tif(this.init) {\n\t\t\t\tcurStart = prevProperty ? prevProperty.startPosition : startPosition;\n\t\t\t\tcurEnd = prevProperty ? prevProperty.endPosition : startPosition;\n\t\t\t} else {\n\t\t\t\tcurStart = startPosition;\n\t\t\t\tcurEnd = endPosition;\n\t\t\t}\n\t\t\tconst curPath =\n\t\t\t\toriginDiffAngle === 360\n\t\t\t\t\t? makeStrokeCircleStr(curStart, curEnd, this.center, this.radius, this.clockWise, largeArc)\n\t\t\t\t\t: makeArcStrokePathStr(curStart, curEnd, this.center, this.radius, this.clockWise, largeArc);\n\n\t\t\ts.sliceStrings.push(curPath);\n\t\t\ts.slicesProperties.push({\n\t\t\t\tstartPosition,\n\t\t\t\tendPosition,\n\t\t\t\tvalue: total,\n\t\t\t\ttotal: s.grandTotal,\n\t\t\t\tstartAngle,\n\t\t\t\tendAngle,\n\t\t\t\tangle: diffAngle\n\t\t\t});\n\n\t\t});\n\t\tthis.init = 0;\n\t}\n\n\tsetupComponents() {\n\t\tlet s = this.state;\n\n\t\tlet componentConfigs = [\n\t\t\t[\n\t\t\t\t'donutSlices',\n\t\t\t\t{ },\n\t\t\t\tfunction() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsliceStrings: s.sliceStrings,\n\t\t\t\t\t\tcolors: this.colors,\n\t\t\t\t\t\tstrokeWidth: this.strokeWidth,\n\t\t\t\t\t};\n\t\t\t\t}.bind(this)\n\t\t\t]\n\t\t];\n\n\t\tthis.components = new Map(componentConfigs\n\t\t\t.map(args => {\n\t\t\t\tlet component = getComponent(...args);\n\t\t\t\treturn [args[0], component];\n\t\t\t}));\n\t}\n\n\tcalTranslateByAngle(property){\n\t\tconst{ radius, hoverRadio } = this;\n\t\tconst position = getPositionByAngle(property.startAngle+(property.angle / 2),radius);\n\t\treturn `translate3d(${(position.x) * hoverRadio}px,${(position.y) * hoverRadio}px,0)`;\n\t}\n\n\thoverSlice(path,i,flag,e){\n\t\tif(!path) return;\n\t\tconst color = this.colors[i];\n\t\tif(flag) {\n\t\t\ttransform(path, this.calTranslateByAngle(this.state.slicesProperties[i]));\n\t\t\tpath.style.stroke = lightenDarkenColor(color, 50);\n\t\t\tlet g_off = getOffset(this.svg);\n\t\t\tlet x = e.pageX - g_off.left + 10;\n\t\t\tlet y = e.pageY - g_off.top - 10;\n\t\t\tlet title = (this.formatted_labels && this.formatted_labels.length > 0\n\t\t\t\t? this.formatted_labels[i] : this.state.labels[i]) + ': ';\n\t\t\tlet percent = (this.state.sliceTotals[i] * 100 / this.state.grandTotal).toFixed(1);\n\t\t\tthis.tip.setValues(x, y, {name: title, value: percent + \"%\"});\n\t\t\tthis.tip.showTip();\n\t\t} else {\n\t\t\ttransform(path,'translate3d(0,0,0)');\n\t\t\tthis.tip.hideTip();\n\t\t\tpath.style.stroke = color;\n\t\t}\n\t}\n\n\tbindTooltip() {\n\t\tthis.container.addEventListener('mousemove', this.mouseMove);\n\t\tthis.container.addEventListener('mouseleave', this.mouseLeave);\n\t}\n\n\tmouseMove(e){\n\t\tconst target = e.target;\n\t\tlet slices = this.components.get('donutSlices').store;\n\t\tlet prevIndex = this.curActiveSliceIndex;\n\t\tlet prevAcitve = this.curActiveSlice;\n\t\tif(slices.includes(target)) {\n\t\t\tlet i = slices.indexOf(target);\n\t\t\tthis.hoverSlice(prevAcitve, prevIndex,false);\n\t\t\tthis.curActiveSlice = target;\n\t\t\tthis.curActiveSliceIndex = i;\n\t\t\tthis.hoverSlice(target, i, true, e);\n\t\t} else {\n\t\t\tthis.mouseLeave();\n\t\t}\n\t}\n\n\tmouseLeave(){\n\t\tthis.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,false);\n\t}\n}\n\n// import MultiAxisChart from './charts/MultiAxisChart';\nconst chartTypes = {\n\tbar: AxisChart,\n\tline: AxisChart,\n\t// multiaxis: MultiAxisChart,\n\tpercentage: PercentageChart,\n\theatmap: Heatmap,\n\tpie: PieChart,\n\tdonut: DonutChart,\n};\n\nfunction getChartByType(chartType = 'line', parent, options) {\n\tif (chartType === 'axis-mixed') {\n\t\toptions.type = 'line';\n\t\treturn new AxisChart(parent, options);\n\t}\n\n\tif (!chartTypes[chartType]) {\n\t\tconsole.error(\"Undefined chart type: \" + chartType);\n\t\treturn;\n\t}\n\n\treturn new chartTypes[chartType](parent, options);\n}\n\nclass Chart {\n\tconstructor(parent, options) {\n\t\treturn getChartByType(options.type, parent, options);\n\t}\n}\n\nexport { Chart, PercentageChart, PieChart, Heatmap, AxisChart };\n","import { Chart } from \"frappe-charts/dist/frappe-charts.esm.js\";\nimport \"frappe-charts/dist/frappe-charts.min.css\";\n\nconst loopCounts = [10_000, 100_000, 1_000_000];\n\nfunction getPerformanceTime(func, loopCount) {\n  const startTime = performance.now();\n  for (let i = 0; i < loopCount; i++) {\n    func();\n  }\n  const endTime = performance.now();\n  return endTime - startTime;\n}\n\nfunction buildDataSet(objectDefinePropertyFunc, proxyFunc) {\n  const measuresObjectDefineProperty = loopCounts.map((loopCount) =>\n    getPerformanceTime(objectDefinePropertyFunc, loopCount)\n  );\n  const measuresProxy = loopCounts.map((loopCount) =>\n    getPerformanceTime(proxyFunc, loopCount)\n  );\n  return {\n    labels: loopCounts,\n    datasets: [\n      {\n        name: \"Object.defineProperty\",\n        type: \"line\",\n        values: measuresObjectDefineProperty,\n      },\n      {\n        name: \"Proxy\",\n        type: \"line\",\n        values: measuresProxy,\n      },\n    ],\n  };\n}\n\nfunction buildChartOptions(title, data) {\n  return {\n    title,\n    data,\n    type: \"line\",\n    height: 250,\n    colors: [\"red\", \"blue\"],\n  };\n}\n\nfunction useObjectDefineProperty1() {\n  const data = { key: \"\" };\n  Object.defineProperty(data, \"key\", {\n    get() {},\n    set() {},\n  });\n}\n\nfunction useProxy1() {\n  const data = { key: \"\" };\n  new Proxy(data, {\n    get() {},\n    set() {},\n  });\n}\n\nfunction useObjectDefineProperty2() {\n  const data = { key: \"\" };\n  let key = \"\";\n  Object.defineProperty(data, \"key\", {\n    get() {\n      return key;\n    },\n    set(newVal) {\n      key = newVal;\n    },\n  });\n  data.key = \"newVal\";\n}\n\nfunction useProxy2() {\n  const data = { key: \"\" };\n  let key = \"\";\n  const proxy = new Proxy(data, {\n    get() {\n      return key;\n    },\n    set(_target, _prop, newVal) {\n      key = newVal;\n      return true;\n    },\n  });\n  proxy.key = \"newVal\";\n}\n\nconst data1 = buildDataSet(useObjectDefineProperty1, useProxy1);\nconst data2 = buildDataSet(useObjectDefineProperty2, useProxy2);\n\ndocument.addEventListener(\n  \"DOMContentLoaded\",\n  () => {\n    new Chart(\"#chart1\", buildChartOptions(\"Only calling\", data1));\n    new Chart(\"#chart2\", buildChartOptions(\"Update key\", data2));\n  },\n  false\n);\n"]}